<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sas.guiframe.data_processor &mdash; SasView 3.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '3.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="SasView 3.1.0 documentation" href="../../../index.html" />
    <link rel="up" title="sas.guiframe" href="../guiframe.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SasView 3.1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../guiframe.html" accesskey="U">sas.guiframe</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sas.guiframe.data_processor</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Implement grid used to store results of a batch fit.</span>

<span class="sd">This is in Guiframe rather than fitting which is probably where it should be.</span>
<span class="sd">Actually could be a generic framework implemented in fit gui module.  At this</span>
<span class="sd">point however there this grid behaves independently of the fitting panel and</span>
<span class="sd">only knows about information sent to it but not about the fits or fit panel and</span>
<span class="sd">thus cannot feed back to the fitting panel.  This could change in the future.</span>

<span class="sd">The organization of the classes goes as:</span>
<span class="sd">.. image::  media/BatchGridClassLayout.png</span>
<span class="sd">   :align:   center</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">wx.lib.scrolledpanel</span> <span class="kn">import</span> <span class="n">ScrolledPanel</span>
<span class="kn">import</span> <span class="nn">wx.aui</span>
<span class="kn">from</span> <span class="nn">wx.aui</span> <span class="kn">import</span> <span class="n">AuiNotebook</span> <span class="k">as</span> <span class="n">nb</span>
<span class="kn">import</span> <span class="nn">wx.lib.sheet</span> <span class="kn">as</span> <span class="nn">sheet</span>
<span class="kn">from</span> <span class="nn">sas.guiframe.panel_base</span> <span class="kn">import</span> <span class="n">PanelBase</span>
<span class="kn">from</span> <span class="nn">sas.guiframe.events</span> <span class="kn">import</span> <span class="n">NewPlotEvent</span>
<span class="kn">from</span> <span class="nn">sas.guiframe.events</span> <span class="kn">import</span> <span class="n">StatusEvent</span>
<span class="kn">from</span> <span class="nn">sas.plottools</span> <span class="kn">import</span> <span class="n">plottables</span>
<span class="kn">from</span> <span class="nn">sas.guiframe.dataFitting</span> <span class="kn">import</span> <span class="n">Data1D</span>


<span class="n">FUNC_DICT</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;sqrt&quot;</span><span class="p">:</span> <span class="s">&quot;math.sqrt&quot;</span><span class="p">,</span>
             <span class="s">&quot;pow&quot;</span><span class="p">:</span> <span class="s">&quot;math.sqrt&quot;</span><span class="p">}</span>

<div class="viewcode-block" id="BatchCell"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.BatchCell">[docs]</a><span class="k">class</span> <span class="nc">BatchCell</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Object describing a cell in  the grid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize attributes of class (label, value, col, row, object)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="p">[]</span>

</div>
<div class="viewcode-block" id="parse_string"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.parse_string">[docs]</a><span class="k">def</span> <span class="nf">parse_string</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a dictionary of column label and index or row selected</span>
<span class="sd">    </span>
<span class="sd">    :param sentence: String to parse</span>
<span class="sd">    :param list: list of columns label</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;\d+&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;[\+\-\*\%\/]&#39;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
    <span class="n">col_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">rang</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">temp_arr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span>  <span class="nb">list</span><span class="p">:</span>
            <span class="n">label_pos</span> <span class="o">=</span> <span class="n">elt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">separator_pos</span> <span class="o">=</span> <span class="n">label_pos</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">elt</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">separator_pos</span>  <span class="ow">and</span>\
                <span class="n">elt</span><span class="p">[</span><span class="n">separator_pos</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;[&quot;</span><span class="p">:</span>
                <span class="c"># the label contain , meaning the range selected is not </span>
                <span class="c"># continuous</span>
                <span class="k">if</span> <span class="n">elt</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">new_temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">elt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                        <span class="n">range_pos</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">range_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">rang</span> <span class="o">=</span> <span class="n">p2</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rang</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">rang</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                                <span class="n">new_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">temp_arr</span> <span class="o">+=</span> <span class="n">new_temp</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># continuous range</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">elt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">range_pos</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">range_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="n">rang</span> <span class="o">=</span> <span class="n">p2</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rang</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">rang</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                                    <span class="n">temp_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">col_dict</span><span class="p">[</span><span class="n">elt</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">temp_arr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">col_dict</span>

</div>
<div class="viewcode-block" id="SPanel"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.SPanel">[docs]</a><span class="k">class</span> <span class="nc">SPanel</span><span class="p">(</span><span class="n">ScrolledPanel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ensure proper scrolling of GridPanel </span>
<span class="sd">    </span>
<span class="sd">    Adds a SetupScrolling call to the normal ScrolledPanel init.    </span>
<span class="sd">    GridPanel then subclasses this class</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize ScrolledPanel then force a call to SetupScrolling</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ScrolledPanel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetupScrolling</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="GridCellEditor"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridCellEditor">[docs]</a><span class="k">class</span> <span class="nc">GridCellEditor</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">CCellEditor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Custom cell editor</span>
<span class="sd">    </span>
<span class="sd">    This subclasses the sheet.CCellEditor (itself a subclass of</span>
<span class="sd">    grid.GridCellEditor) in order to override two of its methods:</span>
<span class="sd">    PaintBackrgound and EndEdit.</span>
<span class="sd">    </span>
<span class="sd">    This is necessary as the sheet module is broken in wx 3.0.2 and</span>
<span class="sd">    improperly subclasses grid.GridCellEditor</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override of CCellEditor init. Runs the grid.GridCellEditor init code</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GridCellEditor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<div class="viewcode-block" id="GridCellEditor.PaintBackground"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridCellEditor.PaintBackground">[docs]</a>    <span class="k">def</span> <span class="nf">PaintBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Overrides wx.sheet.CCellEditor.PaintBackground which incorrectly calls</span>
<span class="sd">        the base class method.</span>
<span class="sd">        </span>
<span class="sd">        In wx3.0 all paint objects must explicitly</span>
<span class="sd">        have a wxPaintDC (Device Context) object.  Thus the paint event which</span>
<span class="sd">        generates a call to this method provides such a DC object and the</span>
<span class="sd">        base class in grid expects to receive that object.  sheet was apparently</span>
<span class="sd">        not updated to reflect this and hence fails.  This could thus</span>
<span class="sd">        become obsolete in a future bug fix of wxPython.</span>
<span class="sd">        </span>
<span class="sd">        Apart from adding a dc variable in the list of arguments in the def</span>
<span class="sd">        and in the call to the base class the rest of this method is copied</span>
<span class="sd">        as is from sheet.CCellEditor.PaintBackground</span>
<span class="sd">        </span>
<span class="sd">        :param dc: the wxDC object for the paint</span>
<span class="sd">        -------</span>
<span class="sd">        Draws the part of the cell not occupied by the edit control.  The</span>
<span class="sd">        base class version just fills it with background colour from the</span>
<span class="sd">        attribute.</span>

<span class="sd">        NOTE: There is no need to override this if you don&#39;t need</span>
<span class="sd">        to do something out of the ordinary.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Call base class method.</span>
        <span class="n">DC</span> <span class="o">=</span> <span class="n">dc</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">CCellEditor</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">PaintBackground</span><span class="p">(</span><span class="n">DC</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridCellEditor.EndEdit"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridCellEditor.EndEdit">[docs]</a>    <span class="k">def</span> <span class="nf">EndEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">previous</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Commit editing the current cell. Returns True if the value has changed.</span>
<span class="sd">        </span>
<span class="sd">        :param previous: previous value in the cell</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>                             <span class="c"># Assume value not changed</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>                   <span class="c"># Get value in edit control</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_startValue</span><span class="p">:</span>                 <span class="c"># Compare</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>                          <span class="c"># If different then changed is True</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">GetTable</span><span class="p">()</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="c"># Update the table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_startValue</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>                       <span class="c"># Clear the class&#39; start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>                       <span class="c"># Clear contents of the edit control</span>
        <span class="k">return</span> <span class="n">changed</span>

</div></div>
<div class="viewcode-block" id="GridPage"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage">[docs]</a><span class="k">class</span> <span class="nc">GridPage</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">CSheet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class that receives the results of a batch fit.</span>
<span class="sd">    </span>
<span class="sd">    GridPage displays the received results in a wx.grid using sheet.  This is</span>
<span class="sd">    then used by GridPanel and GridFrame to present the full GUI.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">panel</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize</span>
<span class="sd">        </span>
<span class="sd">        Initialize all the attributes of GridPage, and the events. include</span>
<span class="sd">        the init stuff from sheet.CSheet as well.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#sheet.CSheet.__init__(self, parent)</span>
        
        <span class="c"># The following is the __init__ from CSheet. ##########################</span>
        <span class="c"># We re-write it here because the class is broken in wx 3.0,</span>
        <span class="c"># such that the cell editor is not able to receive the right</span>
        <span class="c"># number of parameters when it is called. The only way to</span>
        <span class="c"># pick a different cell editor is apparently to re-write the __init__.</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">Grid</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c"># Init variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastCol</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>              <span class="c"># Init last cell column clicked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastRow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>              <span class="c"># Init last cell row clicked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="bp">None</span>           <span class="c"># Init range currently selected</span>
                                        <span class="c"># Map string datatype to default renderer/editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RegisterDataType</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">GRID_VALUE_STRING</span><span class="p">,</span>
                              <span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">GridCellStringRenderer</span><span class="p">(),</span>
                              <span class="n">GridCellEditor</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CreateGrid</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>           <span class="c"># By default start with a 4 x 3 grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetColLabelSize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>        <span class="c"># Default sizes and alignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRowLabelSize</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRowLabelAlignment</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_BOTTOM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetColSize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>          <span class="c"># Default column sizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetColSize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetColSize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>

        <span class="c"># Sink events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_RANGE_SELECT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnRangeSelect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_ROW_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnRowSize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_COL_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnColSize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_SELECT_CELL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnGridSelectCell</span><span class="p">)</span>
        <span class="c"># NOTE: the following bind to standard sheet methods that are</span>
        <span class="c"># overriden in this subclassn - actually we have currently</span>
        <span class="c"># disabled the on_context_menu that would override the OnRightClick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_CELL_CHANGE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnCellChange</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_CELL_LEFT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnLeftClick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_CELL_RIGHT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnRightClick</span><span class="p">)</span>
        <span class="c">#self.Bind(wx.grid.EVT_GRID_CELL_LEFT_DCLICK, self.OnLeftDoubleClick)</span>
        <span class="c"># This ends the __init__ section for CSheet. ##########################</span>



        <span class="c"># The following events must be bound even if CSheet is working </span>
        <span class="c"># properly and does not need the above re-implementation of the</span>
        <span class="c"># CSheet init method.  Basically these override any intrinsic binding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_LABEL_RIGHT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_right_click</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">EVT_GRID_LABEL_LEFT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_left_click</span><span class="p">)</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">AdjustScrollbars</span><span class="p">()</span>
        <span class="c">#self.SetLabelBackgroundColour(&#39;#DBD4D4&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">panel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_inputs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cols</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="mi">3001</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_selected_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_selected_col</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_width</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_height</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottable_cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottable_flag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetColMinimalAcceptableWidth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetRowMinimalAcceptableHeight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_height</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetNumberRows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetNumberCols</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cols</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">GetBackgroundColour</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cols</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetCellBackgroundColour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AutoSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_plot_panels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_col_width</span> <span class="o">=</span> <span class="mi">75</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EnableEditing</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_col_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetColSize</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c"># We have moved these to the top of the init section with the </span>
        <span class="c"># rest of the grid event bindings from the sheet init when </span>
        <span class="c"># appropriate</span>
        <span class="c">#self.Bind(wx.grid.EVT_GRID_LABEL_LEFT_CLICK, self.on_left_click)</span>
        <span class="c">#self.Bind(wx.grid.EVT_GRID_LABEL_RIGHT_CLICK, self.on_right_click)</span>
        <span class="c">#self.Bind(wx.grid.EVT_GRID_CELL_LEFT_CLICK, self.on_selected_cell)</span>
        <span class="c">#self.Bind(wx.grid.EVT_GRID_CMD_CELL_CHANGE, self.on_edit_cell)</span>
        <span class="c">#self.Bind(wx.grid.EVT_GRID_CELL_RIGHT_CLICK, self.onContextMenu)</span>

<div class="viewcode-block" id="GridPage.OnLeftClick"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.OnLeftClick">[docs]</a>    <span class="k">def</span> <span class="nf">OnLeftClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides sheet.CSheet.OnLefClick.</span>
<span class="sd">        </span>
<span class="sd">        Processes when a cell is selected by left clicking on that cell. First</span>
<span class="sd">        process the base Sheet method then the current class specific method</span>
<span class="sd">         </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sheet</span><span class="o">.</span><span class="n">CSheet</span><span class="o">.</span><span class="n">OnLeftClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_selected_cell</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        
</div>
<div class="viewcode-block" id="GridPage.OnCellChange"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.OnCellChange">[docs]</a>    <span class="k">def</span> <span class="nf">OnCellChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides sheet.CSheet.OnCellChange.  </span>
<span class="sd">        </span>
<span class="sd">        Processes when a cell has been edited by a cell editor. Checks for the</span>
<span class="sd">        edited row being outside the max row to use attribute and if so updates</span>
<span class="sd">        the last row.  Then calls the base handler using skip. </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetRow</span><span class="p">(),</span> <span class="n">event</span><span class="o">.</span><span class="n">GetCol</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.on_selected_cell"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_selected_cell">[docs]</a>    <span class="k">def</span> <span class="nf">on_selected_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler catching cell selection.</span>
<span class="sd">        </span>
<span class="sd">        Called after calling base &#39;on left click&#39; method.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">flag</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">CmdDown</span><span class="p">()</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">ControlDown</span><span class="p">()</span>
        <span class="n">flag_shift</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">ShiftDown</span><span class="p">()</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetRow</span><span class="p">(),</span> <span class="n">event</span><span class="o">.</span><span class="n">GetCol</span><span class="p">()</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">flag_shift</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottable_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottable_cells</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottable_flag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_selected_col</span> <span class="o">=</span> <span class="n">col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_selected_row</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">label_row</span> <span class="o">=</span> <span class="n">row</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label_row</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">label_row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flag_shift</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">:</span>
                <span class="n">min_r</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row_s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_r</span><span class="p">,</span> <span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">cel</span> <span class="o">=</span> <span class="p">(</span><span class="n">row_s</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cel</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row_s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">:</span>
                <span class="n">cel</span> <span class="o">=</span> <span class="p">(</span><span class="n">row_s</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">row_s</span> <span class="o">&gt;</span> <span class="n">row</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cel</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">row_s</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">flag</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cell</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cell_row</span><span class="p">,</span> <span class="n">cell_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cell_row</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">cell_row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">cell_row</span><span class="p">,</span> <span class="n">cell_col</span><span class="p">))</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.on_left_click"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_left_click">[docs]</a>    <span class="k">def</span> <span class="nf">on_left_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is triggered when the left mouse button is clicked while the mouse</span>
<span class="sd">        is hovering over the column &#39;label.&#39; </span>
<span class="sd">        </span>
<span class="sd">        This processes the information on the selected column: the column name</span>
<span class="sd">        (in row 0 of column) and the range of cells with a valid value to be</span>
<span class="sd">        used by the GridPanel set_axis methods.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">flag</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">CmdDown</span><span class="p">()</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">ControlDown</span><span class="p">()</span>

        <span class="n">col</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetCol</span><span class="p">()</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetRow</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottable_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottable_cells</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plottable_flag</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_selected_col</span> <span class="o">=</span> <span class="n">col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_selected_row</span> <span class="o">=</span> <span class="n">row</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">row</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cell</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cell_row</span><span class="p">,</span> <span class="n">cell_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">cell_row</span><span class="p">,</span> <span class="n">cell_col</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">cell_row</span><span class="p">,</span> <span class="n">cell_col</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s">&quot; &quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.on_right_click"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_right_click">[docs]</a>    <span class="k">def</span> <span class="nf">on_right_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is triggered when the right mouse button is clicked while the mouse</span>
<span class="sd">        is hovering over the column &#39;label.&#39; </span>
<span class="sd">        </span>
<span class="sd">        This brings up a context menu that allows the deletion of the column,</span>
<span class="sd">        or the insertion of a new column either to the right or left of the </span>
<span class="sd">        current column.  If inserting a new column can insert a blank column or</span>
<span class="sd">        choose a number of hidden columns.  By default all the error parameters</span>
<span class="sd">        are in hidden columns so as to save space on the grid.  Also any other</span>
<span class="sd">        intrinsic variables stored with the data such as Temperature, pressure,</span>
<span class="sd">        time etc can be used to populate this menu.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">col</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetCol</span><span class="p">()</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetRow</span><span class="p">()</span>
        <span class="c"># Ignore the index column</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">row</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="c"># Slicer plot popup menu</span>
        <span class="n">slicerpop</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">col_label_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">c_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;Insert column before </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_name</span><span class="p">)</span>
        <span class="n">slicerpop</span><span class="o">.</span><span class="n">AppendSubMenu</span><span class="p">(</span><span class="n">col_label_menu</span><span class="p">,</span> <span class="s">&#39;&amp;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_col_menu</span><span class="p">(</span><span class="n">col_label_menu</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">col_after_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;Insert column after </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_name</span><span class="p">)</span>
        <span class="n">slicerpop</span><span class="o">.</span><span class="n">AppendSubMenu</span><span class="p">(</span><span class="n">col_after_menu</span><span class="p">,</span> <span class="s">&#39;&amp;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_after_col_menu</span><span class="p">(</span><span class="n">col_after_menu</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&#39;Remove selected column </span><span class="si">%s</span><span class="s">&#39;</span>
        <span class="n">slicerpop</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s">&#39;&amp;Remove Column&#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_remove_column</span><span class="p">)</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">GetMousePosition</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ScreenToClient</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PopupMenu</span><span class="p">(</span><span class="n">slicerpop</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.insert_col_menu"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.insert_col_menu">[docs]</a>    <span class="k">def</span> <span class="nf">insert_col_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        method called to populate the &#39;insert column before current column&#39;</span>
<span class="sd">        submenu.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Empty&quot;</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&#39;Insert empty column before </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_insert_column</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">())]</span>
        <span class="k">for</span> <span class="n">c_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">c_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c_name</span><span class="p">]:</span>
                <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
                <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Insert </span><span class="si">%s</span><span class="s"> column before the &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_name</span><span class="p">)</span>
                <span class="n">hint</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> column&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s">&#39;&amp;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_name</span><span class="p">),</span> <span class="n">hint</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_insert_column</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPage.insert_after_col_menu"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.insert_after_col_menu">[docs]</a>    <span class="k">def</span> <span class="nf">insert_after_col_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method called to populate the &#39;insert column after current column&#39;</span>
<span class="sd">        submenu</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Empty&quot;</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&#39;Insert empty column after </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_insert_after_column</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">())]</span>
        <span class="k">for</span> <span class="n">c_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">c_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">c_name</span><span class="p">]:</span>
                <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
                <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Insert </span><span class="si">%s</span><span class="s"> column after the &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_name</span><span class="p">)</span>
                <span class="n">hint</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> column&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s">&#39;&amp;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_name</span><span class="p">),</span> <span class="n">hint</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_insert_after_column</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPage.on_remove_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_remove_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when user chooses remove from the column right click menu</span>
<span class="sd">        Checks the columnn exists then calls the remove_column method</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">numCols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPage.remove_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.remove_column">[docs]</a>    <span class="k">def</span> <span class="nf">remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">numCols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the col column from the current grid</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c"># add data to the grid    </span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">col_name</span><span class="p">:</span>
                        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">:</span>
                            <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span> <span class="o">-</span> <span class="n">length</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">diff</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DeleteCols</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">numCols</span><span class="o">=</span><span class="n">numCols</span><span class="p">,</span> <span class="n">updateLabels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPage.on_insert_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_insert_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_insert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when user chooses insert &#39;column before&#39; submenu</span>
<span class="sd">        of the column context menu obtained when right clicking on a given</span>
<span class="sd">        column header.</span>
<span class="sd">        </span>
<span class="sd">        Sets up to insert column into the current grid before the current</span>
<span class="sd">        highlighted column location and sets up what to populate that column</span>
<span class="sd">        with.  Then calls insert_column method to actually do the insertion. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c"># add data to the grid</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">GetLabelText</span><span class="p">(</span><span class="n">wx_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">col_name</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
            <span class="k">if</span>  <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
                <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="GridPage.on_insert_after_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_insert_after_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_insert_after_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when user chooses insert &#39;column after&#39; submenu</span>
<span class="sd">        of the column context menu obtained when right clicking on a given</span>
<span class="sd">        column header. </span>
<span class="sd">        </span>
<span class="sd">        Sets up to insert column into the current grid after the current</span>
<span class="sd">        highlighted column location and sets up what to populate that column</span>
<span class="sd">        with.  Then calls insert_column method to actually do the insertion. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="c"># add data to the grid</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">GetLabelText</span><span class="p">(</span><span class="n">wx_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insert_column</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">col_name</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
            <span class="k">if</span>  <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="GridPage.insert_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.insert_column">[docs]</a>    <span class="k">def</span> <span class="nf">insert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert column at position col with data[col_name] into the current</span>
<span class="sd">        grid.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InsertCols</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">numCols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">updateLabels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">col_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&quot;Empty&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">value_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
            <span class="n">cell_row</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">value_list</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">value</span><span class="c">#format_number(value, high=True)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetCellValue</span><span class="p">(</span><span class="n">cell_row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
                <span class="n">cell_row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AutoSizeColumn</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetColSize</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_col_width</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetColSize</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_col_width</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">GetBackgroundColour</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCellBackgroundColour</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ForceRefresh</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.on_set_x_axis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_set_x_axis">[docs]</a>    <span class="k">def</span> <span class="nf">on_set_x_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Just calls the panel version of the method</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">set_xaxis</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPage.on_set_y_axis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_set_y_axis">[docs]</a>    <span class="k">def</span> <span class="nf">on_set_y_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Just calls the panel version of the method</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">set_yaxis</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_value</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_label</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPage.set_data"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_inputs</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">,</span> <span class="n">details</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add data to the grid</span>
<span class="sd">        </span>
<span class="sd">        :param data_inputs: data to use from the context menu of the grid</span>
<span class="sd">        :param data_ouputs: default columns deplayed</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>

        <span class="k">if</span> <span class="n">data_outputs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data_outputs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span> <span class="o">=</span> <span class="n">data_outputs</span>
        <span class="k">if</span> <span class="n">data_inputs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data_inputs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_inputs</span> <span class="o">=</span> <span class="n">data_inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_inputs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">col_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">col_names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">nbr_user_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_names</span><span class="p">)</span>
            <span class="c">#Add more columns to the grid if necessary</span>
            <span class="k">if</span> <span class="n">nbr_user_cols</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cols</span><span class="p">:</span>
                <span class="n">new_col_nbr</span> <span class="o">=</span> <span class="n">nbr_user_cols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cols</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">AppendCols</span><span class="p">(</span><span class="n">new_col_nbr</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="c">#Add more rows to the grid if necessary</span>
            <span class="n">nbr_user_row</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">nbr_user_row</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_row_nbr</span> <span class="o">=</span> <span class="n">nbr_user_row</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">AppendRows</span><span class="p">(</span><span class="n">new_row_nbr</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="c"># add data to the grid</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_grid_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ForceRefresh</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.set_grid_values"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.set_grid_values">[docs]</a>    <span class="k">def</span> <span class="nf">set_grid_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the values in grids</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c"># add data to the grid</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cell_col</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">col_names</span><span class="p">:</span>
            <span class="c"># use the first row of the grid to add user defined labels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="p">))</span>
            <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cell_row</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">value_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">value_list</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">BatchCell</span><span class="p">):</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">label</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="c">#format_number(label, high=True)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetCellValue</span><span class="p">(</span><span class="n">cell_row</span><span class="p">,</span> <span class="n">cell_col</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">AutoSizeColumn</span><span class="p">(</span><span class="n">cell_col</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetColSize</span><span class="p">(</span><span class="n">cell_col</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_col_width</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetColSize</span><span class="p">(</span><span class="n">cell_col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_col_width</span><span class="p">)</span>

                <span class="n">cell_row</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cell_col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">cell_row</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span> <span class="o">=</span> <span class="n">cell_row</span>
</div>
<div class="viewcode-block" id="GridPage.get_grid_view"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.get_grid_view">[docs]</a>    <span class="k">def</span> <span class="nf">get_grid_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return value contained in the grid</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">grid_view</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">()):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                <span class="n">grid_view</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_row_touse</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">grid_view</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">grid_view</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">grid_view</span>
</div>
<div class="viewcode-block" id="GridPage.get_nofrows"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.get_nofrows">[docs]</a>    <span class="k">def</span> <span class="nf">get_nofrows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return number of total rows</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span>
</div>
<div class="viewcode-block" id="GridPage.onContextMenu"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.onContextMenu">[docs]</a>    <span class="k">def</span> <span class="nf">onContextMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to handle cell right click context menu. </span>
<span class="sd">        </span>
<span class="sd">        THIS METHOD IS NOT CURRENTLY USED.  It is designed to provide a</span>
<span class="sd">        cell pop up context by right clicking on a cell and gives the</span>
<span class="sd">        option to cut, paste, and clear. This will probably be removed in</span>
<span class="sd">        future versions and is being superceded by more traditional cut and</span>
<span class="sd">        paste options.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">c_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">copy_menu</span> <span class="o">=</span> <span class="n">c_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s">&#39;&amp;Copy&#39;</span><span class="p">,</span> <span class="s">&#39;Copy the selected cells&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_copy</span><span class="p">)</span>

        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">c_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s">&#39;&amp;Paste&#39;</span><span class="p">,</span> <span class="s">&#39;Paste the selected cells&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_paste</span><span class="p">)</span>

        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">clear_menu</span> <span class="o">=</span> <span class="n">c_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s">&#39;&amp;Clear&#39;</span><span class="p">,</span> <span class="s">&#39;Clear the selected cells&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_clear</span><span class="p">)</span>

        <span class="c"># enable from flag</span>
        <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">selected_cel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_cells</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_cel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">_row</span><span class="p">,</span> <span class="n">_col</span> <span class="o">=</span> <span class="n">selected_cel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsInSelection</span><span class="p">(</span><span class="n">_row</span><span class="p">,</span> <span class="n">_col</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">copy_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">has_selection</span><span class="p">)</span>
        <span class="n">clear_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">has_selection</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># mouse event pos</span>
            <span class="n">pos_evt</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PopupMenu</span><span class="p">(</span><span class="n">c_menu</span><span class="p">,</span> <span class="n">pos_evt</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span>
</div>
<div class="viewcode-block" id="GridPage.on_copy"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_copy">[docs]</a>    <span class="k">def</span> <span class="nf">on_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when copy is chosen from cell right click context menu</span>

<span class="sd">        THIS METHOD IS NOT CURRENTLY USED.  it is part of right click cell</span>
<span class="sd">        context menu which is being removed. This will probably be removed in</span>
<span class="sd">        future versions and is being superceded by more traditional cut and</span>
<span class="sd">        paste options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.on_paste"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_paste">[docs]</a>    <span class="k">def</span> <span class="nf">on_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when paste is chosen from cell right click context menu</span>
<span class="sd">        </span>
<span class="sd">        THIS METHOD IS NOT CURRENTLY USED.  it is part of right click cell</span>
<span class="sd">        context menu which is being removed. This will probably be removed in</span>
<span class="sd">        future versions and is being superceded by more traditional cut and</span>
<span class="sd">        paste options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="s">&#39;copied_data&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Paste</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPage.on_clear"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPage.on_clear">[docs]</a>    <span class="k">def</span> <span class="nf">on_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when clear cell is chosen from cell right click context menu</span>

<span class="sd">        THIS METHOD IS NOT CURRENTLY USED.  it is part of right click cell</span>
<span class="sd">        context menu which is being removed. This will probably be removed in</span>
<span class="sd">        future versions and is being superceded by more traditional cut and</span>
<span class="sd">        paste options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="Notebook"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook">[docs]</a><span class="k">class</span> <span class="nc">Notebook</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span> <span class="n">PanelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ## Internal name for the AUI manager</span>
<span class="sd">    window_name = &quot;Fit panel&quot;</span>
<span class="sd">    ## Title to appear on top of the window</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">window_caption</span> <span class="o">=</span> <span class="s">&quot;Notebook &quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">manager</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nb</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_WINDOWLIST_BUTTON</span> <span class="o">|</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_BUTTON_DOWN</span> <span class="o">|</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_DEFAULT_STYLE</span> <span class="o">|</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">CLIP_CHILDREN</span><span class="p">)</span>
        <span class="n">PanelBase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpage_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_close_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="c">#add empty page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_empty_page</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pageClosedEvent</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">EVT_AUINOTEBOOK_PAGE_CLOSE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pageClosedEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_close_page</span><span class="p">)</span>

<div class="viewcode-block" id="Notebook.add_empty_page"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.add_empty_page">[docs]</a>    <span class="k">def</span> <span class="nf">add_empty_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">GridPage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddPage</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPageIndex</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Table&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpage_num</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetPageText</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_close_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpage_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">grid</span><span class="p">,</span> <span class="n">pos</span>
</div>
<div class="viewcode-block" id="Notebook.enable_close_button"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.enable_close_button">[docs]</a>    <span class="k">def</span> <span class="nf">enable_close_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        display the close button on the tab if more than 1 tab exits.</span>
<span class="sd">        Otherwise remove the close button</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPageCount</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindowStyleFlag</span><span class="p">()</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_CLOSE_ON_ACTIVE_TAB</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">&amp;</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_CLOSE_ON_ACTIVE_TAB</span> <span class="o">==</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">style</span> <span class="o">=</span> <span class="n">style</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_CLOSE_ON_ACTIVE_TAB</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetWindowStyle</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetWindowStyleFlag</span><span class="p">()</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_CLOSE_ON_ACTIVE_TAB</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">&amp;</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_CLOSE_ON_ACTIVE_TAB</span> <span class="o">!=</span> <span class="n">flag</span><span class="p">:</span>
                <span class="n">style</span> <span class="o">|=</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_CLOSE_ON_ACTIVE_TAB</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetWindowStyle</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Notebook.on_edit_axis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.on_edit_axis">[docs]</a>    <span class="k">def</span> <span class="nf">on_edit_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the select cell range from a given selected column. Checks that</span>
<span class="sd">        all cells are from the same column</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="c">#grid.selected_cols = [grid.GetSelectedRows()]#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">col</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Edit axis doesn&#39;t understand this selection.</span><span class="se">\n</span><span class="s">&quot;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Please select only one column&quot;</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">msg</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">cell_col</span><span class="p">)</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cell_col</span> <span class="o">!=</span> <span class="n">col</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Cannot use cells from different columns for &quot;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;this operation.</span><span class="se">\n</span><span class="s">&quot;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Please select elements of the same col.</span><span class="se">\n</span><span class="s">&quot;</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">msg</span>

            <span class="c"># Finally check the highlighted cell if any cells missing</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_highlighted_row</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;No item selected.</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Please select only one column or one cell&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">return</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span>
</div>
<div class="viewcode-block" id="Notebook.get_highlighted_row"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.get_highlighted_row">[docs]</a>    <span class="k">def</span> <span class="nf">get_highlighted_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_number</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add highlight rows</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># Finally check the highlighted cell if any cells missing</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">get_nofrows</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">IsInSelection</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
                <span class="n">cel</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_number</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c"># empty cell</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">cel</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                        <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cel</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">is_number</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="c"># non numeric cell</span>
                        <span class="k">if</span> <span class="n">cel</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                            <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">cel</span><span class="p">)</span>
                        <span class="k">continue</span>
                <span class="k">if</span> <span class="n">cel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
                    <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cel</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Notebook.get_column_labels"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.get_column_labels">[docs]</a>    <span class="k">def</span> <span class="nf">get_column_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return dictionary of columns labels on the current page</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">()):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetColLabelValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">col</span>
        <span class="k">return</span> <span class="n">labels</span>
</div>
<div class="viewcode-block" id="Notebook.create_axis_label"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.create_axis_label">[docs]</a>    <span class="k">def</span> <span class="nf">create_axis_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receive a list of cells and  create a string presenting the selected</span>
<span class="sd">        cells that can be used as data for one axis of a plot.</span>
<span class="sd">        </span>
<span class="sd">        :param cell_list: list of tuple</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">create_label</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="n">row_min</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">row_max</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s">&quot; &quot;</span>
            <span class="k">if</span> <span class="n">row_min</span> <span class="ow">is</span> <span class="ow">not</span>  <span class="bp">None</span> <span class="ow">or</span> <span class="n">row_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">row_min</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;]&quot;</span>
                <span class="k">elif</span> <span class="n">row_max</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row_min</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row_min</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span>
                    <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row_max</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;]&quot;</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">row_min</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">cell_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetColLabelValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>

                <span class="n">col_title</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">create_label</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="n">row_min</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_min</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span>  <span class="n">label</span><span class="p">,</span> <span class="n">col_title</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">cell_list</span><span class="p">)</span>
                <span class="n">temp_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>
                <span class="n">row_min</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">temp_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">row_max</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">temp_list</span><span class="p">[</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetColLabelValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
                <span class="n">col_title</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

                <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">row_min</span><span class="p">,</span> <span class="n">row_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_list</span><span class="p">):</span>
                        <span class="n">new_row</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">temp_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">row</span> <span class="o">!=</span> <span class="n">new_row</span><span class="p">:</span>
                            <span class="n">temp_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
                            <span class="k">if</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">new_row</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">temp_list</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">new_row</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">new_row</span> <span class="o">!=</span> <span class="s">&#39; &#39;</span><span class="p">:</span>
                                    <span class="n">label</span> <span class="o">+=</span> <span class="n">create_label</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                                                          <span class="nb">int</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">label</span> <span class="o">+=</span> <span class="s">&quot;]&quot;</span>
                                <span class="n">label</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
                            <span class="k">if</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_list</span><span class="p">):</span>
                                <span class="n">new_row</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">temp_list</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">new_row</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                                    <span class="n">label</span> <span class="o">+=</span> <span class="n">create_label</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span>
                                                          <span class="nb">int</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">row_min</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">row_max</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">label</span> <span class="o">+=</span> <span class="n">create_label</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span>
                                                  <span class="nb">int</span><span class="p">(</span><span class="n">row_min</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">label</span> <span class="o">+=</span> <span class="n">create_label</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span>
                                                  <span class="nb">int</span><span class="p">(</span><span class="n">row_max</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c"># clean up the list</span>
                <span class="n">label_out</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;]&quot;</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">label_out</span> <span class="o">+=</span> <span class="n">item</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span>

                <span class="k">return</span> <span class="n">label_out</span><span class="p">,</span> <span class="n">col_title</span>
</div>
<div class="viewcode-block" id="Notebook.on_close_page"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.on_close_page">[docs]</a>    <span class="k">def</span> <span class="nf">on_close_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        close the page</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPageCount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Veto</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enable_close_button</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Notebook.set_data"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_inputs</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data_outputs</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">data_outputs</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="k">return</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_odered_results</span><span class="p">(</span><span class="n">data_inputs</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetPageCount</span><span class="p">()):</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c">#Found empty page</span>
                <span class="n">grid</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
                              <span class="n">data_outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
                              <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">,</span>
                              <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="n">grid</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_empty_page</span><span class="p">()</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
                      <span class="n">data_outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
                      <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                      <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Notebook.get_odered_results"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.get_odered_results">[docs]</a>    <span class="k">def</span> <span class="nf">get_odered_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Order a list of &#39;inputs.&#39; Used to sort rows and columns to present</span>
<span class="sd">        in batch results grid.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Let&#39;s re-order the data from the keys in &#39;Data&#39; name.</span>
        <span class="k">if</span> <span class="n">outputs</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># For outputs from batch</span>
            <span class="n">to_be_sort</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">label</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">[</span><span class="s">&#39;Data&#39;</span><span class="p">]]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c"># When inputs are from an external file</span>
            <span class="k">return</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">to_be_sort</span><span class="p">,</span> <span class="n">to_be_sort</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">key_list</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">temp_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">key_list</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">:</span>
                <span class="n">temp_key</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_list</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
            <span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_key</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inputs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">key_list</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">):</span>
                <span class="n">temp_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">key_list</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">:</span>
                    <span class="n">temp_key</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_list</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
                <span class="n">inputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">inputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span>
</div>
<div class="viewcode-block" id="Notebook.add_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.add_column">[docs]</a>    <span class="k">def</span> <span class="nf">add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append a new column to the grid</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">AppendCols</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Notebook.on_remove_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.Notebook.on_remove_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the selected column from the grid</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">on_remove_column</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="GridPanel"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel">[docs]</a><span class="k">class</span> <span class="nc">GridPanel</span><span class="p">(</span><span class="n">SPanel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ScrolledPanel class that contains the grid sheet as well as a number of</span>
<span class="sd">    widgets to create interesting plots and buttons for help etc. </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">data_inputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">data_outputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the GridPanel</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">SPanel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vbox</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vbox</span><span class="o">.</span><span class="n">AddMany</span><span class="p">([(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_sizer</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                           <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                           <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_sizer</span><span class="p">),</span>
                           <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_inputs</span> <span class="o">=</span> <span class="n">data_inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_outputs</span> <span class="o">=</span> <span class="n">data_outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_label</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_label</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_label</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_title</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_title</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_unit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_unit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view_button</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_button</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout_grid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout_plotting_area</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vbox</span><span class="p">)</span>

<div class="viewcode-block" id="GridPanel.set_xaxis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.set_xaxis">[docs]</a>    <span class="k">def</span> <span class="nf">set_xaxis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_label</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">[:]&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_title</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GridPanel.set_yaxis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.set_yaxis">[docs]</a>    <span class="k">def</span> <span class="nf">set_yaxis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_label</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">[:]&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_title</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GridPanel.set_dyaxis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.set_dyaxis">[docs]</a>    <span class="k">def</span> <span class="nf">set_dyaxis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_label</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">[:]&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GridPanel.get_plot_axis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.get_plot_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_plot_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;data&quot;</span><span class="p">:</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Invalid data in row </span><span class="si">%s</span><span class="s"> column </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                                     <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                        <span class="k">return</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axis</span>
</div>
<div class="viewcode-block" id="GridPanel.on_view"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.on_view">[docs]</a>    <span class="k">def</span> <span class="nf">on_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get object represented by the given cells and plot them.  Basically</span>
<span class="sd">        plot the colum in y vs the column in x.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPageText</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">get_highlighted_row</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Highlight a Data or Chi2 column first...&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Too many data (&gt; 20) to plot...&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s"> Please select no more than 20 data.&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="s">&#39;Plotting&#39;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">:</span>
            <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">cell</span>
            <span class="n">label_row</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">label_row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">or</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Invalid cell was chosen.&quot;</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">BatchCell</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">object</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Row </span><span class="si">%s</span><span class="s"> , &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Column </span><span class="si">%s</span><span class="s"> is NOT &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;the results of fits to view...&quot;</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                        <span class="k">return</span>
                    <span class="k">for</span> <span class="n">new_plot</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">object</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">new_plot</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> \
                         <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span>
                                        <span class="n">plottables</span><span class="o">.</span><span class="n">Plottable</span><span class="p">):</span>
                            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Row </span><span class="si">%s</span><span class="s"> , &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Column </span><span class="si">%s</span><span class="s"> is NOT &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;the results of fits to view...&quot;</span>
                            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                                         <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                            <span class="k">return</span>
                        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">Data1D</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">list_plot_panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">group_id</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">list_plot_panels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">group_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
                                <span class="n">grid</span><span class="o">.</span><span class="n">list_plot_panels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_id</span>
                            <span class="k">if</span> <span class="n">group_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">list_group_id</span><span class="p">:</span>
                                <span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span> <span class="o">=</span> <span class="n">group_id</span>
                                <span class="n">new_plot</span><span class="o">.</span><span class="n">list_group_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_id</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">label</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;chi2&quot;</span><span class="p">]:</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                                    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;2D View: Please select one data set&quot;</span>
                                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot; at a time for View Fit Results.&quot;</span>
                                    <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                                                 <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                                    <span class="k">return</span>

                        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                                     <span class="n">NewPlotEvent</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">new_plot</span><span class="p">,</span>
                                                  <span class="n">group_id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span><span class="p">),</span>
                                                  <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">))</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Plotting the View Fit Results  completed!&quot;</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Row </span><span class="si">%s</span><span class="s"> , &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Column </span><span class="si">%s</span><span class="s"> is NOT &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;the results of fits to view...&quot;</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                    <span class="k">return</span>
</div>
<div class="viewcode-block" id="GridPanel.on_plot"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.on_plot">[docs]</a>    <span class="k">def</span> <span class="nf">on_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate the contains of textcrtl and plot result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">get_column_labels</span><span class="p">()</span>
        <span class="c">#evaluate x</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_label</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Select column values for x axis&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;X axis value error.&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="nb">dict</span> <span class="o">=</span> <span class="n">parse_string</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sentence</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Need a proper x-range.&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="c">#evaluate y</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_label</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;select value for y axis&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Y axis value error.&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="nb">dict</span> <span class="o">=</span> <span class="n">parse_string</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sentence</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Need a proper y-range.&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="c">#evaluate y</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_label</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">sentence</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="nb">dict</span> <span class="o">=</span> <span class="n">parse_string</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sentence</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Need a proper dy-range.&quot;</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Need same length for X and Y axis and both greater than 0&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot; to plot.</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Got X length = </span><span class="si">%s</span><span class="s">, Y length = </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dy</span><span class="p">)):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Need same length for Y and dY axis and both greater than 0&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot; to plot.</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Got Y length = </span><span class="si">%s</span><span class="s">, dY length = </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dy</span><span class="p">)))</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="c">#plotting</span>
        <span class="n">new_plot</span> <span class="o">=</span> <span class="n">Data1D</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">)</span>
        <span class="n">new_plot</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">new_plot</span><span class="o">.</span><span class="n">is_data</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">y_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_title</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">x_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_title</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_vs_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">y_title</span><span class="p">,</span> <span class="n">x_title</span><span class="p">)</span>
        <span class="n">new_plot</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">x_title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_unit</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="n">new_plot</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">y_title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_unit</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">y_title</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">title</span> <span class="o">+=</span> <span class="s">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPageText</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">title</span> <span class="o">+=</span> <span class="s">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">new_plot</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">title</span>
            <span class="n">new_plot</span><span class="o">.</span><span class="n">xtransform</span> <span class="o">=</span> <span class="s">&quot;x&quot;</span>
            <span class="n">new_plot</span><span class="o">.</span><span class="n">ytransform</span> <span class="o">=</span> <span class="s">&quot;y&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                         <span class="n">NewPlotEvent</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">new_plot</span><span class="p">,</span>
                                      <span class="n">group_id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Plotting completed!&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">update_theory</span><span class="p">(</span><span class="n">data_id</span><span class="o">=</span><span class="n">new_plot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">theory</span><span class="o">=</span><span class="n">new_plot</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GridPanel.on_help"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.on_help">[docs]</a>    <span class="k">def</span> <span class="nf">on_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bring up the Batch Grid Panel Usage Documentation whenever</span>
<span class="sd">        the HELP button is clicked.</span>

<span class="sd">        Calls DocumentationWindow with the path of the location within the</span>
<span class="sd">        documentation tree (after /doc/ ....&quot;.  Note that when using old</span>
<span class="sd">        versions of Wx (before 2.9) and thus not the release version of</span>
<span class="sd">        installers, the help comes up at the top level of the file as</span>
<span class="sd">        webbrowser does not pass anything past the # to the browser when it is</span>
<span class="sd">        running &quot;file:///....&quot;</span>

<span class="sd">        :param evt: Triggers on clicking the help button</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c">#import documentation window here to avoid circular imports</span>
        <span class="c">#if put at top of file with rest of imports.</span>
        <span class="kn">from</span> <span class="nn">documentation_window</span> <span class="kn">import</span> <span class="n">DocumentationWindow</span>

        <span class="n">_TreeLocation</span> <span class="o">=</span> <span class="s">&quot;user/perspectives/fitting/fitting_help.html&quot;</span>
        <span class="n">_PageAnchor</span> <span class="o">=</span> <span class="s">&quot;#batch-fit-mode&quot;</span>
        <span class="n">_doc_viewer</span> <span class="o">=</span> <span class="n">DocumentationWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">_TreeLocation</span><span class="p">,</span> <span class="n">_PageAnchor</span><span class="p">,</span>
                                          <span class="s">&quot;Batch Mode Help&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPanel.get_sentence"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.get_sentence">[docs]</a>    <span class="k">def</span> <span class="nf">get_sentence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">column_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get sentence from dict</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">tok</span><span class="p">,</span> <span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_axis</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="s">&quot;numpy.array(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">FUNC_DICT</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sentence</span>
</div>
<div class="viewcode-block" id="GridPanel.layout_grid"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.layout_grid">[docs]</a>    <span class="k">def</span> <span class="nf">layout_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the area related to the grid by adding it as the first element</span>
<span class="sd">        in the panel&#39;s grid_sizer</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="o">=</span> <span class="n">Notebook</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_outputs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPanel.layout_plotting_area"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.layout_plotting_area">[docs]</a>    <span class="k">def</span> <span class="nf">layout_plotting_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the area containing all the plot options, buttons etc to a plotting</span>
<span class="sd">        area sizer to later be added to the top level grid_sizer</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">view_description</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;Plot Fits/Residuals&#39;</span><span class="p">)</span>
        <span class="n">note</span> <span class="o">=</span> <span class="s">&quot;To plot the fits (or residuals), click the &#39;View Fits&#39; button&quot;</span>
        <span class="n">note</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s"> after highlighting the Data names (or Chi2 values).&quot;</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">note</span><span class="p">)</span>
        <span class="n">boxsizer1</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">view_description</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_title</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_title</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_label</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_label</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_label</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_add</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Add&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_add</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_edit_axis</span><span class="p">,</span>
                             <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axis_add</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_add</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Add&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_add</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_edit_axis</span><span class="p">,</span>
                             <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axis_add</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_add</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Add&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_add</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_edit_axis</span><span class="p">,</span>
                              <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_add</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_unit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_unit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;View Fits&quot;</span><span class="p">)</span>
        <span class="n">view_tip</span> <span class="o">=</span> <span class="s">&quot;Highlight the data set or the Chi2 column first.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">view_tip</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_view</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Plot&quot;</span><span class="p">)</span>
        <span class="n">plot_tip</span> <span class="o">=</span> <span class="s">&quot;Highlight a column for each axis and </span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">plot_tip</span> <span class="o">+=</span> <span class="s">&quot;click the Add buttons first.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">plot_tip</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">help_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;HELP&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="s">&quot;Get Help for Batch Mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_button</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_help</span><span class="p">)</span>

        <span class="n">boxsizer1</span><span class="o">.</span><span class="n">AddMany</span><span class="p">([(</span><span class="n">note_text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                           <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="o">.</span><span class="n">AddMany</span><span class="p">([(</span><span class="n">boxsizer1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help_button</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> 
                                    <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">12</span><span class="p">)])</span>

        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_sizer</span><span class="o">.</span><span class="n">AddMany</span><span class="p">(</span>\
                   <span class="p">[(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;X-axis Label</span><span class="se">\n</span><span class="s">Selection Range&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axis_label</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axis_add</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;X-axis Label&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axis_title</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;X-axis Unit&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axis_unit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Y-axis Label</span><span class="se">\n</span><span class="s">Selection Range&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axis_label</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axis_add</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Y-axis Label&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axis_title</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Y-axis Unit&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axis_unit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;dY-Bar (Optional)</span><span class="se">\n</span><span class="s">Selection Range&quot;</span><span class="p">),</span>
                     <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_label</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_add</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</div>
<div class="viewcode-block" id="GridPanel.on_edit_axis"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.on_edit_axis">[docs]</a>    <span class="k">def</span> <span class="nf">on_edit_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the selected column on  the visible grid and set values for axis</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cell_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">on_edit_axis</span><span class="p">()</span>
            <span class="n">label</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_axis_label</span><span class="p">(</span><span class="n">cell_list</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="n">tcrtl</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tcrtl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_axis_helper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axis_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axis_title</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tcrtl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_axis_helper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axis_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axis_title</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tcrtl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_axis_helper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dy_axis_label</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPanel.create_axis_label"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.create_axis_label">[docs]</a>    <span class="k">def</span> <span class="nf">create_axis_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receive a list of cells and  create a string presenting the selected</span>
<span class="sd">        cells.</span>

<span class="sd">        :param cell_list: list of tuple</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">create_axis_label</span><span class="p">(</span><span class="n">cell_list</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridPanel.edit_axis_helper"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.edit_axis_helper">[docs]</a>    <span class="k">def</span> <span class="nf">edit_axis_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcrtl_label</span><span class="p">,</span> <span class="n">tcrtl_title</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get controls to modify</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">tcrtl_label</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">tcrtl_title</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="GridPanel.add_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.add_column">[docs]</a>    <span class="k">def</span> <span class="nf">add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">add_column</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridPanel.on_remove_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridPanel.on_remove_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">on_remove_column</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="GridFrame"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame">[docs]</a><span class="k">class</span> <span class="nc">GridFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The main wx.Frame for the batch results grid</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data_inputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data_outputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s">&quot;Batch Fitting Results Panel&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">500</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Frame</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">GridPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_inputs</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">)</span>
        <span class="n">menubar</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="n">menubar</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">curr_col</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curr_grid</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curr_col_name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s">&quot;&amp;File&quot;</span><span class="p">)</span>

        <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Open file containing batch results&quot;</span>
        <span class="n">open_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s">&#39;Open &#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">open_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_open</span><span class="p">)</span>

        <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Open the the current grid into excel&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_excel_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s">&#39;Open with Excel&#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_excel_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_with_excel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">(),</span> <span class="s">&#39;Save As&#39;</span><span class="p">,</span> <span class="s">&#39;Save into File&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_save_page</span><span class="p">)</span>

        <span class="c"># We need to grab a WxMenu handle here, otherwise the next one to grab</span>
        <span class="c"># the handle will be treated as the Edit Menu handle when checking in</span>
        <span class="c"># on_menu_open event handler and thus raise an exception when it hits an </span>
        <span class="c"># unitialized object.  Alternative is to comment out that whole section</span>
        <span class="c"># in on_menu_open, but that would make it more difficult to undo the</span>
        <span class="c"># hidding of the menu.   PDB  July 12, 2015.</span>
        <span class="c">#</span>
        <span class="c"># To enable the Edit menubar comment out next line and uncomment the</span>
        <span class="c"># following line.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="c">#self.add_edit_menu()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU_OPEN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_menu_open</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">)</span>

<div class="viewcode-block" id="GridFrame.add_edit_menu"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.add_edit_menu">[docs]</a>    <span class="k">def</span> <span class="nf">add_edit_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menubar</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        populates the edit menu on the menubar.  Not activated as of SasView</span>
<span class="sd">        3.1.0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>

        <span class="n">add_table_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;New Table&#39;</span><span class="p">,</span>
                                          <span class="s">&#39;Add a New Table&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_table_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_table</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">copy_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;Copy&#39;</span><span class="p">,</span>
                                          <span class="s">&#39;Copy the selected cells&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_copy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paste_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;Paste&#39;</span><span class="p">,</span>
                                           <span class="s">&#39;Paste the selected Cells&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">paste_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_paste</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;Clear&#39;</span><span class="p">,</span>
                                           <span class="s">&#39;Clear the selected Cells&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_clear</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Insert column before the selected column&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_before_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insertb_sub_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">AppendSubMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_before_menu</span><span class="p">,</span>
                                                        <span class="s">&#39;Insert Before&#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Insert column after the selected column&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_after_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inserta_sub_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">AppendSubMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_after_menu</span><span class="p">,</span>
                                                        <span class="s">&#39;Insert After&#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;Remove the selected column&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;Remove Column&#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_menu</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_remove_column</span><span class="p">)</span>
        <span class="n">menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit</span><span class="p">,</span> <span class="s">&quot;&amp;Edit&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.on_copy"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_copy">[docs]</a>    <span class="k">def</span> <span class="nf">on_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On Copy from the Edit menu item on the menubar  </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">Copy</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridFrame.on_paste"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_paste">[docs]</a>    <span class="k">def</span> <span class="nf">on_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On Paste from the Edit menu item on the menubar</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">on_paste</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.on_clear"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_clear">[docs]</a>    <span class="k">def</span> <span class="nf">on_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On Clear from the Edit menu item on the menubar</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridFrame.GetLabelText"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.GetLabelText">[docs]</a>    <span class="k">def</span> <span class="nf">GetLabelText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get Label Text</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_before_menu</span><span class="o">.</span><span class="n">GetMenuItems</span><span class="p">():</span>
            <span class="n">m_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">m_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridFrame.on_remove_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_remove_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On remove column from the Edit menu Item on the menubar</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I Believe this is no longer used now that we have removed the </span>
        <span class="c"># edit menu from the menubar - PDB July 12, 2015</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">on_remove_column</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.on_menu_open"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_menu_open">[docs]</a>    <span class="k">def</span> <span class="nf">on_menu_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On menu open</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">==</span> <span class="n">event</span><span class="o">.</span><span class="n">GetMenu</span><span class="p">():</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">has_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">grid</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open_excel_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">has_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">has_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit</span> <span class="o">==</span> <span class="n">event</span><span class="o">.</span><span class="n">GetMenu</span><span class="p">():</span>
            <span class="c">#get the selected column</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">col_list</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetSelectedCols</span><span class="p">()</span>
            <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">selected_cel</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">selected_cells</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_cel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">_row</span><span class="p">,</span> <span class="n">_col</span> <span class="o">=</span> <span class="n">selected_cel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">has_selection</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">IsInSelection</span><span class="p">(</span><span class="n">_row</span><span class="p">,</span> <span class="n">_col</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">selected_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">has_selection</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">copy_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">has_selection</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">has_selection</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertb_sub_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inserta_sub_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;Insert Column Before&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertb_sub_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;Insert Column After&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inserta_sub_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertb_sub_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inserta_sub_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

                <span class="n">col</span> <span class="o">=</span> <span class="n">col_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCellValue</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;Insert Column Before &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertb_sub_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_before_menu</span><span class="o">.</span><span class="n">GetMenuItems</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">insert_before_menu</span><span class="o">.</span><span class="n">DeleteItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">grid</span><span class="o">.</span><span class="n">insert_col_menu</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_before_menu</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;Insert Column After &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inserta_sub_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_after_menu</span><span class="o">.</span><span class="n">GetMenuItems</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">insert_after_menu</span><span class="o">.</span><span class="n">DeleteItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">grid</span><span class="o">.</span><span class="n">insert_after_col_menu</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_after_menu</span><span class="p">,</span>
                                           <span class="n">label</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>


</div>
<div class="viewcode-block" id="GridFrame.on_save_page"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_save_page">[docs]</a>    <span class="k">def</span> <span class="nf">on_save_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves data in grid to a csv file.</span>
<span class="sd">        </span>
<span class="sd">        At this time only the columns displayed get saved.  Thus any error</span>
<span class="sd">        bars not inserted before saving will not be saved in the file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">grid</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ow">or</span> \
                <span class="n">grid</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPageText</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> has not data to save&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                             <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>

                <span class="k">return</span>
            <span class="n">reader</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;Save Project file&quot;</span><span class="p">,</span>
                                    <span class="n">location</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">SAVE</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">path</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_grid_view</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">write_batch_tofile</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                                       <span class="n">file_name</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                                                       <span class="n">details</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">details</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.on_open"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_open">[docs]</a>    <span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open file containing batch result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_read_batch_tofile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.open_with_excel"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.open_with_excel">[docs]</a>    <span class="k">def</span> <span class="nf">open_with_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        open excel and display batch result in Excel</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_grid_view</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">grid</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ow">or</span> \
                <span class="n">grid</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">GetPageText</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> has not data to open on excel&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                             <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&quot;error&quot;</span><span class="p">))</span>

                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">open_with_externalapp</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                              <span class="n">file_name</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span>
                                              <span class="n">details</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">details</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.on_close"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_close">[docs]</a>    <span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridFrame.on_append_column"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.on_append_column">[docs]</a>    <span class="k">def</span> <span class="nf">on_append_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append a new column to the grid</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">add_column</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GridFrame.set_data"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_inputs</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_inputs</span><span class="o">=</span><span class="n">data_inputs</span><span class="p">,</span>
                                     <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                                     <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">,</span>
                                     <span class="n">data_outputs</span><span class="o">=</span><span class="n">data_outputs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="GridFrame.add_table"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.GridFrame.add_table">[docs]</a>    <span class="k">def</span> <span class="nf">add_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new table</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># DO not event.Skip(): it will make 2 pages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">add_empty_page</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="BatchOutputFrame"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.BatchOutputFrame">[docs]</a><span class="k">class</span> <span class="nc">BatchOutputFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allow to select where the result of batch will be displayed or stored</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">data_inputs</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                 <span class="n">details</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialog</span>

<span class="sd">        :param parent: Window instantiating this dialog</span>
<span class="sd">        :param result: result to display in a grid or export to an external</span>
<span class="sd">                application.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c">#kwds[&#39;style&#39;] = wx.CAPTION|wx.SYSTEM_MENU</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_inputs</span> <span class="o">=</span> <span class="n">data_inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span> <span class="o">=</span> <span class="n">data_outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_inputs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_app_selected</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_app_selected</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_layout</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_do_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the content of the current dialog window</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vbox</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">box_description</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s">&quot;Batch Outputs&quot;</span><span class="p">))</span>
        <span class="n">hint_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">box_description</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">selection_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">GridBagSizer</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">button_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Open with </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">application_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_app_selected</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">RB_GROUP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onselect</span><span class="p">,</span>
                  <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">local_app_selected</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Open with Excel&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_app_selected</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onselect</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">external_app_selected</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Save to File&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onselect</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_app_selected</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_app_selected</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">button_close</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Close&quot;</span><span class="p">)</span>
        <span class="n">button_close</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">button_close</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">)</span>
        <span class="n">button_apply</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Apply&quot;</span><span class="p">)</span>
        <span class="n">button_apply</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">button_apply</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_apply</span><span class="p">)</span>
        <span class="n">button_apply</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">hint_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">hint</span><span class="p">))</span>
        <span class="n">hint_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">selection_sizer</span><span class="p">)</span>
        <span class="c">#draw area containing radio buttons</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">selection_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">local_app_selected</span><span class="p">,</span> <span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">),</span>
                            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ADJUST_MINSIZE</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">iy</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">selection_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">external_app_selected</span><span class="p">,</span> <span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">),</span>
                            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ADJUST_MINSIZE</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">iy</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">selection_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">,</span> <span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">),</span>
                            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ADJUST_MINSIZE</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="c">#contruction the sizer contaning button</span>
        <span class="n">button_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ADJUST_MINSIZE</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">button_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">button_close</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ADJUST_MINSIZE</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">button_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">button_apply</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ADJUST_MINSIZE</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">hint_sizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticLine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">button_sizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>

<div class="viewcode-block" id="BatchOutputFrame.on_apply"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.BatchOutputFrame.on_apply">[docs]</a>    <span class="k">def</span> <span class="nf">on_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the user selection and display output to the selected application</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">open_with_localapp</span><span class="p">(</span><span class="n">data_inputs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_inputs</span><span class="p">,</span>
                                           <span class="n">data_outputs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_outputs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">open_with_externalapp</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                              <span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span>
                                              <span class="n">details</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">)</span></div>
<div class="viewcode-block" id="BatchOutputFrame.on_close"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.BatchOutputFrame.on_close">[docs]</a>    <span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        close the Window</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="BatchOutputFrame.onselect"><a class="viewcode-back" href="../../../dev/api/sas.guiframe.html#sas.guiframe.data_processor.BatchOutputFrame.onselect">[docs]</a>    <span class="k">def</span> <span class="nf">onselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receive event and display data into third party application</span>
<span class="sd">        or save data to file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;Save Project file&quot;</span><span class="p">,</span>
                                    <span class="n">location</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">SAVE</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">path</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>  <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">write_batch_tofile</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                       <span class="n">file_name</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                                                       <span class="n">details</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_app_selected</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span>


</div></div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&quot;index&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>

        <span class="n">data_input</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data_input</span><span class="p">[</span><span class="s">&quot;index5&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">GridFrame</span><span class="p">(</span><span class="n">data_outputs</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">data_inputs</span><span class="o">=</span><span class="n">data_input</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>

    <span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SasView 3.1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../guiframe.html" >sas.guiframe</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, The SasView Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>