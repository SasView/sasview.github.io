<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sas.sasgui.guiframe.gui_manager &mdash; SasView 4.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '4.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="SasView 4.0.0 documentation" href="../../../../index.html" />
    <link rel="up" title="sas.sasgui.guiframe" href="../guiframe.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">SasView 4.0.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../guiframe.html" accesskey="U">sas.sasgui.guiframe</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sas.sasgui.guiframe.gui_manager</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gui manager: manages the widgets making up an application</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">################################################################################</span>
<span class="c1">#This software was developed by the University of Tennessee as part of the</span>
<span class="c1">#Distributed Data Analysis of Neutron Scattering Experiments (DANSE)</span>
<span class="c1">#project funded by the US National Science Foundation.</span>
<span class="c1">#</span>
<span class="c1">#See the license text in license.txtz</span>
<span class="c1">#</span>
<span class="c1">#copyright 2008, University of Tennessee</span>
<span class="c1">################################################################################</span>


<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">wx.aui</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">imp</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">httplib</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_CATEGORY</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_STATUS</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_APPEND_BOOKMARK</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_PANEL_ON_FOCUS</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_NEW_LOAD_DATA</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_NEW_COLOR</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">StatusEvent</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">NewPlotEvent</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.gui_style</span> <span class="kn">import</span> <span class="n">GUIFRAME</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.gui_style</span> <span class="kn">import</span> <span class="n">GUIFRAME_ID</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.data_panel</span> <span class="kn">import</span> <span class="n">DataPanel</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.panel_base</span> <span class="kn">import</span> <span class="n">PanelBase</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.gui_toolbar</span> <span class="kn">import</span> <span class="n">GUIToolBar</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.data_processor</span> <span class="kn">import</span> <span class="n">GridFrame</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.events</span> <span class="kn">import</span> <span class="n">EVT_NEW_BATCH</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.CategoryManager</span> <span class="kn">import</span> <span class="n">CategoryManager</span>
<span class="kn">from</span> <span class="nn">sas.sascalc.dataloader.loader</span> <span class="kn">import</span> <span class="n">Loader</span>
<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.proxy</span> <span class="kn">import</span> <span class="n">Connection</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_pylab_helpers</span>


<div class="viewcode-block" id="get_app_dir"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.get_app_dir">[docs]</a><span class="k">def</span> <span class="nf">get_app_dir</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The application directory is the one where the default custom_config.py</span>
<span class="sd">        file resides.</span>

<span class="sd">        :returns: app_path - the path to the applicatin directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First, try the directory of the executable we are running</span>
    <span class="n">app_path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">app_path</span><span class="p">):</span>
        <span class="n">app_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">app_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="s2">&quot;custom_config.py&quot;</span><span class="p">)):</span>
        <span class="n">app_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">app_path</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using application path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">app_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">app_path</span>

    <span class="c1"># Next, try the current working directory</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;custom_config.py&quot;</span><span class="p">)):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using application path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

    <span class="c1"># Finally, try the directory of the sasview module</span>
    <span class="c1"># TODO: gui_manager will have to know about sasview until we</span>
    <span class="c1"># clean all these module variables and put them into a config class</span>
    <span class="c1"># that can be passed by sasview.py.</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">sas</span> <span class="kn">import</span> <span class="n">sasview</span> <span class="k">as</span> <span class="n">sasview</span>
    <span class="n">app_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sasview</span><span class="o">.</span><span class="n">__file__</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using application path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">app_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">app_path</span></div>

<div class="viewcode-block" id="get_user_directory"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.get_user_directory">[docs]</a><span class="k">def</span> <span class="nf">get_user_directory</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the user&#39;s home directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">userdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;.sasview&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">userdir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">userdir</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">userdir</span></div>

<span class="k">def</span> <span class="nf">_find_local_config</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find configuration file for the current application</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_module</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">fObj</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fObj</span><span class="p">,</span> <span class="n">path_config</span><span class="p">,</span> <span class="n">descr</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="p">[</span><span class="n">path</span><span class="p">])</span>
        <span class="n">config_module</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">fObj</span><span class="p">,</span> <span class="n">path_config</span><span class="p">,</span> <span class="n">descr</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error loading </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">))</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fObj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fObj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GuiManager loaded </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">config_module</span>

<span class="c1"># Get APP folder</span>
<span class="n">PATH_APP</span> <span class="o">=</span> <span class="n">get_app_dir</span><span class="p">()</span>
<span class="n">DATAPATH</span> <span class="o">=</span> <span class="n">PATH_APP</span>

<span class="c1"># GUI always starts from the App folder</span>
<span class="c1">#os.chdir(PATH_APP)</span>
<span class="c1"># Read in the local config, which can either be with the main</span>
<span class="c1"># application or in the installation directory</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">_find_local_config</span><span class="p">(</span><span class="s1">&#39;local_config&#39;</span><span class="p">,</span> <span class="n">PATH_APP</span><span class="p">)</span>
<span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">_find_local_config</span><span class="p">(</span><span class="s1">&#39;local_config&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Didn&#39;t find local config, load the default</span>
        <span class="kn">import</span> <span class="nn">sas.sasgui.guiframe.config</span> <span class="kn">as</span> <span class="nn">config</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;using default local_config&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;found local_config in </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;found local_config in </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PATH_APP</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.customdir</span>  <span class="kn">import</span> <span class="n">SetupCustom</span>
<span class="n">c_conf_dir</span> <span class="o">=</span> <span class="n">SetupCustom</span><span class="p">()</span><span class="o">.</span><span class="n">setup_dir</span><span class="p">(</span><span class="n">PATH_APP</span><span class="p">)</span>
<span class="n">custom_config</span> <span class="o">=</span> <span class="n">_find_local_config</span><span class="p">(</span><span class="s1">&#39;custom_config&#39;</span><span class="p">,</span> <span class="n">c_conf_dir</span><span class="p">)</span>
<span class="k">if</span> <span class="n">custom_config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">custom_config</span> <span class="o">=</span> <span class="n">_find_local_config</span><span class="p">(</span><span class="s1">&#39;custom_config&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">custom_config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">msgConfig</span> <span class="o">=</span> <span class="s2">&quot;Custom_config file was not imported&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msgConfig</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;using custom_config in </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;using custom_config from </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">c_conf_dir</span><span class="p">)</span>

<span class="c1">#read some constants from config</span>
<span class="n">APPLICATION_STATE_EXTENSION</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION_STATE_EXTENSION</span>
<span class="n">APPLICATION_NAME</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">__appname__</span>
<span class="n">SPLASH_SCREEN_PATH</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">SPLASH_SCREEN_PATH</span>
<span class="n">WELCOME_PANEL_ON</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">WELCOME_PANEL_ON</span>
<span class="n">SPLASH_SCREEN_WIDTH</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">SPLASH_SCREEN_WIDTH</span>
<span class="n">SPLASH_SCREEN_HEIGHT</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">SPLASH_SCREEN_HEIGHT</span>
<span class="n">SS_MAX_DISPLAY_TIME</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">SS_MAX_DISPLAY_TIME</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">WELCOME_PANEL_ON</span><span class="p">:</span>
    <span class="n">WELCOME_PANEL_SHOW</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">WELCOME_PANEL_SHOW</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">DATALOADER_SHOW</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">DATALOADER_SHOW</span>
    <span class="n">TOOLBAR_SHOW</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">TOOLBAR_SHOW</span>
    <span class="n">FIXED_PANEL</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">FIXED_PANEL</span>
    <span class="k">if</span> <span class="n">WELCOME_PANEL_ON</span><span class="p">:</span>
        <span class="n">WELCOME_PANEL_SHOW</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">WELCOME_PANEL_SHOW</span>
    <span class="n">PLOPANEL_WIDTH</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">PLOPANEL_WIDTH</span>
    <span class="n">DATAPANEL_WIDTH</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">DATAPANEL_WIDTH</span>
    <span class="n">GUIFRAME_WIDTH</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">GUIFRAME_WIDTH</span>
    <span class="n">GUIFRAME_HEIGHT</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">GUIFRAME_HEIGHT</span>
    <span class="n">CONTROL_WIDTH</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">CONTROL_WIDTH</span>
    <span class="n">CONTROL_HEIGHT</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">CONTROL_HEIGHT</span>
    <span class="n">DEFAULT_PERSPECTIVE</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">DEFAULT_PERSPECTIVE</span>
    <span class="n">CLEANUP_PLOT</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">CLEANUP_PLOT</span>
    <span class="c1"># custom open_path</span>
    <span class="n">open_folder</span> <span class="o">=</span> <span class="n">custom_config</span><span class="o">.</span><span class="n">DEFAULT_OPEN_FOLDER</span>
    <span class="k">if</span> <span class="n">open_folder</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">open_folder</span><span class="p">):</span>
        <span class="n">DEFAULT_OPEN_FOLDER</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">open_folder</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DEFAULT_OPEN_FOLDER</span> <span class="o">=</span> <span class="n">PATH_APP</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">DATALOADER_SHOW</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">TOOLBAR_SHOW</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">FIXED_PANEL</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">WELCOME_PANEL_SHOW</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">PLOPANEL_WIDTH</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">PLOPANEL_WIDTH</span>
    <span class="n">DATAPANEL_WIDTH</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">DATAPANEL_WIDTH</span>
    <span class="n">GUIFRAME_WIDTH</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">GUIFRAME_WIDTH</span>
    <span class="n">GUIFRAME_HEIGHT</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">GUIFRAME_HEIGHT</span>
    <span class="n">CONTROL_WIDTH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">CONTROL_HEIGHT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">DEFAULT_PERSPECTIVE</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">CLEANUP_PLOT</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">DEFAULT_OPEN_FOLDER</span> <span class="o">=</span> <span class="n">PATH_APP</span>

<span class="n">DEFAULT_STYLE</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">DEFAULT_STYLE</span>

<span class="n">PLUGIN_STATE_EXTENSIONS</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">PLUGIN_STATE_EXTENSIONS</span>
<span class="n">OPEN_SAVE_MENU</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">OPEN_SAVE_PROJECT_MENU</span>
<span class="n">VIEW_MENU</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">VIEW_MENU</span>
<span class="n">EDIT_MENU</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">EDIT_MENU</span>
<span class="n">extension_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">APPLICATION_STATE_EXTENSION</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">extension_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">APPLICATION_STATE_EXTENSION</span><span class="p">)</span>
<span class="n">EXTENSIONS</span> <span class="o">=</span> <span class="n">PLUGIN_STATE_EXTENSIONS</span> <span class="o">+</span> <span class="n">extension_list</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">PLUGINS_WLIST</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">PLUGINS_WLIST</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">PLUGINS_WLIST</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">APPLICATION_WLIST</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">APPLICATION_WLIST</span>
<span class="n">IS_WIN</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">IS_LINUX</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">CLOSE_SHOW</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">TIME_FACTOR</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">MDI_STYLE</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_FRAME_STYLE</span>
<span class="n">NOT_SO_GRAPH_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BoxSum&quot;</span><span class="p">]</span>
<span class="n">PARENT_FRAME</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MDIParentFrame</span>
<span class="n">CHILD_FRAME</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MDIChildFrame</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;win32&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">IS_WIN</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">TIME_FACTOR</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">CLOSE_SHOW</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;darwin&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">IS_LINUX</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">PARENT_FRAME</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span>
        <span class="n">CHILD_FRAME</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span>

<div class="viewcode-block" id="ViewerFrame"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame">[docs]</a><span class="k">class</span> <span class="nc">ViewerFrame</span><span class="p">(</span><span class="n">PARENT_FRAME</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main application frame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">GUIFRAME_WIDTH</span><span class="p">,</span> <span class="n">GUIFRAME_HEIGHT</span><span class="p">),</span>
                 <span class="n">gui_style</span><span class="o">=</span><span class="n">DEFAULT_STYLE</span><span class="p">,</span>
                 <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_FRAME_STYLE</span><span class="p">,</span>
                 <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Frame object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">PARENT_FRAME</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="c1"># title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">=</span> <span class="n">gui_style</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
        <span class="n">temp_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;images&#39;</span><span class="p">)</span>
        <span class="n">ico_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_path</span><span class="p">,</span> <span class="s1">&#39;ball.ico&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ico_file</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">ico_file</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_ICO</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">temp_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;images&#39;</span><span class="p">)</span>
            <span class="n">ico_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_path</span><span class="p">,</span> <span class="s1">&#39;ball.ico&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ico_file</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">ico_file</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_ICO</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ico_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                        <span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;ball.ico&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ico_file</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">ico_file</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_ICO</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">PATH_APP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">application_name</span> <span class="o">=</span> <span class="n">APPLICATION_NAME</span>
        <span class="c1">## Application manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mgr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#add current perpsective</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plotting_plugin</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#Menu bar and item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_appl_menu</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#tool bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># Status bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sb</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># number of plugins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_perspectives</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># plot duck cleanup option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleanup_plots</span> <span class="o">=</span> <span class="n">CLEANUP_PLOT</span>
        <span class="c1">## Find plug-ins</span>
        <span class="c1"># Modify this so that we can specify the directory to look into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#add local plugin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_local_plugins</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_plugins</span><span class="p">()</span>
        <span class="c1">## List of panels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># List of plot panels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># default Graph number fot the plotpanel caption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_num</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Default locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">DEFAULT_OPEN_FOLDER</span>
        <span class="c1"># Welcome panel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">welcome_panel_class</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#panel on focus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#control_panel on focus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">loader</span> <span class="o">=</span> <span class="n">Loader</span><span class="p">()</span>
        <span class="c1">#data manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_on</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.data_manager</span> <span class="kn">import</span> <span class="n">DataManager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span> <span class="o">=</span> <span class="n">DataManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="o">=</span> <span class="bp">None</span><span class="c1">#DataPanel(parent=self)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">set_panel_on_focus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">window_caption</span><span class="p">)</span>
        <span class="c1"># list of plot panels in schedule to full redraw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1">#self.callback = True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_idle_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idletimer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CallLater</span><span class="p">(</span><span class="n">TIME_FACTOR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onDrawIdle</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_frame</span> <span class="o">=</span> <span class="n">GridFrame</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_frame</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_batch_selection</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_icon</span><span class="p">()</span>

        <span class="c1"># Register the close event so it calls our own method</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">WindowClose</span><span class="p">)</span>
        <span class="c1"># Register to status events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_STATUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_status_event</span><span class="p">)</span>
        <span class="c1">#Register add extra data on the same panel event on load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_PANEL_ON_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_panel_on_focus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_APPEND_BOOKMARK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">append_bookmark</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_NEW_LOAD_DATA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_load_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_NEW_BATCH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_batch_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_NEW_COLOR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_color_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_CATEGORY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change_categories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_custom_conf</span><span class="p">()</span>
        <span class="c1"># Preferred window size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span> <span class="o">=</span> <span class="n">size</span>

<div class="viewcode-block" id="ViewerFrame.add_icon"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.add_icon">[docs]</a>    <span class="k">def</span> <span class="nf">add_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get list of child and attempt to add the default icon</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">list_children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetChildren</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">list_children</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">put_icon</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.put_icon"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.put_icon">[docs]</a>    <span class="k">def</span> <span class="nf">put_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Put icon on the tap of a panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;IsIconized&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">frame</span><span class="o">.</span><span class="n">IsIconized</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetIcon</span><span class="p">()</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ViewerFrame.put_icon: could not set icon&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.get_client_size"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_client_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_client_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return client size tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetClientSizeTuple</span><span class="p">()</span>
        <span class="n">height</span> <span class="o">-=</span> <span class="mi">45</span>
        <span class="c1"># Adjust toolbar height</span>
        <span class="n">toolbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetToolBar</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">toolbar</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">tb_h</span> <span class="o">=</span> <span class="n">toolbar</span><span class="o">.</span><span class="n">GetSizeTuple</span><span class="p">()</span>
            <span class="n">height</span> <span class="o">-=</span> <span class="n">tb_h</span>
        <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span></div>

<div class="viewcode-block" id="ViewerFrame.on_change_categories"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_change_categories">[docs]</a>    <span class="k">def</span> <span class="nf">on_change_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="c1"># ILL</span>
        <span class="n">fitpanel</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;get_panels&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;fit_panel&quot;</span><span class="p">):</span>
                    <span class="n">fitpanel</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">fit_panel</span>

        <span class="k">if</span> <span class="n">fitpanel</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fitpanel</span><span class="o">.</span><span class="n">GetPageCount</span><span class="p">()):</span>
                <span class="n">fitpanel</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">_populate_listbox</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.on_set_batch_result"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_set_batch_result">[docs]</a>    <span class="k">def</span> <span class="nf">on_set_batch_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_outputs</span><span class="p">,</span> <span class="n">data_inputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">plugin_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display data into a grid in batch mode and show the grid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="n">time_str</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%b </span><span class="si">%d</span><span class="s2"> %H;%M of %Y&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">details</span> <span class="o">=</span> <span class="s2">&quot;File Generated by </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">APPLICATION_NAME</span><span class="p">,</span>
                                                 <span class="nb">str</span><span class="p">(</span><span class="n">plugin_name</span><span class="p">))</span>
        <span class="n">details</span> <span class="o">+=</span> <span class="s2">&quot;on </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">time_str</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.csv&quot;</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;Batch_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">plugin_name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">time_str</span> <span class="o">+</span> <span class="n">ext</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">open_with_localapp</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                                <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">,</span>
                                <span class="n">data_inputs</span><span class="o">=</span><span class="n">data_inputs</span><span class="p">,</span>
                                <span class="n">data_outputs</span><span class="o">=</span><span class="n">data_outputs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.open_with_localapp"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.open_with_localapp">[docs]</a>    <span class="k">def</span> <span class="nf">open_with_localapp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_inputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                           <span class="n">data_outputs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display value of data into the application grid</span>
<span class="sd">        :param data: dictionary of string and list of items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_frame</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_inputs</span><span class="o">=</span><span class="n">data_inputs</span><span class="p">,</span>
                                  <span class="n">data_outputs</span><span class="o">=</span><span class="n">data_outputs</span><span class="p">,</span>
                                  <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">,</span>
                                  <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_batch_frame</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_read_batch_tofile"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_read_batch_tofile">[docs]</a>    <span class="k">def</span> <span class="nf">on_read_batch_tofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a file dialog , extract the file to read and display values</span>
<span class="sd">        into a grid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">wildcard</span> <span class="o">=</span> <span class="s2">&quot;(*.csv; *.txt)|*.csv; *.txt&quot;</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="n">base</span><span class="p">,</span>
                            <span class="s2">&quot;Choose a file&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">wildcard</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_batch_tofile</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error occurred when reading the file; </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">path</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
                                           <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.read_batch_tofile"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.read_batch_tofile">[docs]</a>    <span class="k">def</span> <span class="nf">read_batch_tofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract value from file name and Display them into a grid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">file_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
        <span class="n">fd_buffer</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">fd_buffer</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">column_names_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">details</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">separator</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="c1">#found the first line containing the label</span>
                <span class="n">col_name_toks</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">col_name_toks</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1">#found the first line containing the label</span>
                    <span class="n">col_name_toks</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">col_name_toks</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">details</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">column_names_line</span> <span class="o">=</span> <span class="n">line</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">column_names_line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">col_name_toks</span> <span class="o">=</span> <span class="n">column_names_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="n">c_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col_name_toks</span><span class="p">)):</span>
            <span class="n">c_name</span> <span class="o">=</span> <span class="n">col_name_toks</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">c_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="c1"># distinguish between column name and value</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">c_name</span><span class="p">)</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="s2">&quot;Column </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">index_min</span> <span class="o">=</span> <span class="n">index</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="n">c_name</span>
                    <span class="n">index_min</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)[</span><span class="n">c_index</span><span class="p">]</span>
                                  <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index_min</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
                <span class="n">c_index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">open_with_localapp</span><span class="p">(</span><span class="n">data_outputs</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">data_inputs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.write_batch_tofile"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.write_batch_tofile">[docs]</a>    <span class="k">def</span> <span class="nf">write_batch_tofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper to write result from batch into cvs file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">file_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># On Permission denied: IOError</span>
            <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">get_user_directory</span><span class="p">()</span>
            <span class="n">temp_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">temp_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">details</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">col_name</span>  <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">col_name</span><span class="p">))</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">max_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">max_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">max_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_list</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">max_index</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">):</span>
                    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value_list</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
                    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.open_with_externalapp"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.open_with_externalapp">[docs]</a>    <span class="k">def</span> <span class="nf">open_with_externalapp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display data in the another application , by default Excel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_batch_tofile</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                                    <span class="n">details</span><span class="o">=</span><span class="n">details</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">win32com.client</span> <span class="kn">import</span> <span class="n">Dispatch</span>
            <span class="n">excel_app</span> <span class="o">=</span> <span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;Excel.Application&#39;</span><span class="p">)</span>
            <span class="n">excel_app</span><span class="o">.</span><span class="n">Workbooks</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">excel_app</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error occured when calling Excel.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;Check that Excel installed in this machine or </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;check that </span><span class="si">%s</span><span class="s2"> really exists.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
                                           <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.on_batch_selection"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_batch_selection">[docs]</a>    <span class="k">def</span> <span class="nf">on_batch_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param event: contains parameter enable. When enable is set to True</span>
<span class="sd">            the application is in Batch mode otherwise the application is</span>
<span class="sd">            in Single mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">batch_on</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">enable</span>
        <span class="k">for</span> <span class="n">plug</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="n">plug</span><span class="o">.</span><span class="n">set_batch_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_on</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_color_selection"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_color_selection">[docs]</a>    <span class="k">def</span> <span class="nf">on_color_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param event: contains parameters for id and color</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">color</span><span class="p">,</span> <span class="n">event_id</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">id</span>
        <span class="k">for</span> <span class="n">plug</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="n">plug</span><span class="o">.</span><span class="n">add_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.setup_custom_conf"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.setup_custom_conf">[docs]</a>    <span class="k">def</span> <span class="nf">setup_custom_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up custom configuration if exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">custom_config</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">FIXED_PANEL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="o">~</span><span class="n">GUIFRAME</span><span class="o">.</span><span class="n">FIXED_PANEL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">|=</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">FLOATING_PANEL</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">DATALOADER_SHOW</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="o">~</span><span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">TOOLBAR_SHOW</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="o">~</span><span class="n">GUIFRAME</span><span class="o">.</span><span class="n">TOOLBAR_ON</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">WELCOME_PANEL_SHOW</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">|=</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">WELCOME_PANEL_ON</span></div>

<div class="viewcode-block" id="ViewerFrame.set_custom_default_perspective"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_custom_default_perspective">[docs]</a>    <span class="k">def</span> <span class="nf">set_custom_default_perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set default starting perspective</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">custom_config</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">plugin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">plugin</span><span class="o">.</span><span class="n">sub_menu</span> <span class="o">==</span> <span class="n">DEFAULT_PERSPECTIVE</span><span class="p">:</span>

                    <span class="n">plugin</span><span class="o">.</span><span class="n">on_perspective</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
                    <span class="n">frame</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="c1">#break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">frame</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="ViewerFrame.on_load_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_load_data">[docs]</a>    <span class="k">def</span> <span class="nf">on_load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        received an event to trigger load from data plugin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.get_current_perspective"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_current_perspective">[docs]</a>    <span class="k">def</span> <span class="nf">get_current_perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the current perspective</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span></div>

<div class="viewcode-block" id="ViewerFrame.get_save_location"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_save_location">[docs]</a>    <span class="k">def</span> <span class="nf">get_save_location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the _default_save_location</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span></div>

<div class="viewcode-block" id="ViewerFrame.set_input_file"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_input_file">[docs]</a>    <span class="k">def</span> <span class="nf">set_input_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param input_file: file to read</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span> <span class="o">=</span> <span class="n">input_file</span></div>

<div class="viewcode-block" id="ViewerFrame.get_data_manager"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_data_manager">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the data manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span></div>

<div class="viewcode-block" id="ViewerFrame.get_toolbar"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_toolbar">[docs]</a>    <span class="k">def</span> <span class="nf">get_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the toolbar.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span></div>

<div class="viewcode-block" id="ViewerFrame.set_panel_on_focus"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_panel_on_focus">[docs]</a>    <span class="k">def</span> <span class="nf">set_panel_on_focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Store reference to the last panel on focus</span>
<span class="sd">        update the toolbar if available</span>
<span class="sd">        update edit menu if available</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">panel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1">#Disable save application if the current panel is in batch mode</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">get_save_flag</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_appl_menu</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_appl_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">on_kill_focus</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_panel_on_focus_helper</span><span class="p">()</span>
                <span class="c1">#update toolbar</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_toolbar_helper</span><span class="p">()</span>
                <span class="c1">#update edit menu</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enable_edit_menu</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.disable_app_menu"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.disable_app_menu">[docs]</a>    <span class="k">def</span> <span class="nf">disable_app_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p_panel</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Disables all menus in the menubar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="ViewerFrame.send_focus_to_datapanel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.send_focus_to_datapanel">[docs]</a>    <span class="k">def</span> <span class="nf">send_focus_to_datapanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send focusing on ID to data explorer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">set_panel_on_focus</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.set_panel_on_focus_helper"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_panel_on_focus_helper">[docs]</a>    <span class="k">def</span> <span class="nf">set_panel_on_focus_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper for panel on focus with data_panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">caption</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">window_caption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_focus_to_datapanel</span><span class="p">(</span><span class="n">caption</span><span class="p">)</span>
        <span class="c1">#update combo</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">combo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span>
            <span class="n">combo_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">window_caption</span><span class="p">)</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">SetStringSelection</span><span class="p">(</span><span class="n">combo_title</span><span class="p">)</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolTip</span><span class="p">(</span><span class="n">combo_title</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="p">:</span>
            <span class="n">cpanel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="o">!=</span> <span class="n">cpanel</span><span class="p">:</span>
                <span class="n">cpanel</span><span class="o">.</span><span class="n">on_tap_focus</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span></div>

<div class="viewcode-block" id="ViewerFrame.reset_bookmark_menu"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.reset_bookmark_menu">[docs]</a>    <span class="k">def</span> <span class="nf">reset_bookmark_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset Bookmark menu list</span>

<span class="sd">        : param panel: a control panel or tap where the bookmark is</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cpanel</span> <span class="o">=</span> <span class="n">panel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">cpanel</span><span class="o">.</span><span class="n">_bookmark_flag</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">get_bookmark_items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">remove_bookmark_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">add_bookmark_default</span><span class="p">()</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">bitem</span> <span class="ow">in</span> <span class="n">cpanel</span><span class="o">.</span><span class="n">popUpMenu</span><span class="o">.</span><span class="n">GetMenuItems</span><span class="p">():</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="n">bitem</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">bitem</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">append_bookmark_item</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">cpanel</span><span class="o">.</span><span class="n">_back_to_bookmark</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">Realize</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.build_gui"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.build_gui">[docs]</a>    <span class="k">def</span> <span class="nf">build_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the GUI by setting up the toolbar, menu and layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set tool bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_tool_bar</span><span class="p">()</span>

        <span class="c1"># Create the menu bar. To be filled later.</span>
        <span class="c1"># WX 3.0 needs us to create the menu bar first.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERSION_STRING</span> <span class="o">&gt;=</span> <span class="s1">&#39;3.0.0.0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_menu_file</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_menu_edit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_menu_view</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_menu_tool</span><span class="p">()</span>
        <span class="c1"># Set up the layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_menu_application</span><span class="p">()</span>

        <span class="c1"># Set up the menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_current_plugin_menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_help_menu</span><span class="p">()</span>
        <span class="c1"># Append item from plugin under menu file if necessary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_file_menu</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERSION_STRING</span> <span class="o">&gt;=</span> <span class="s1">&#39;3.0.0.0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_from_cmd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Cannot load file </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">APPLICATION_NAME</span><span class="p">),</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">fill_cbox_analysis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post_init</span><span class="p">()</span>
        <span class="c1"># Set Custom default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_custom_default_perspective</span><span class="p">()</span>
        <span class="c1"># Set up extra custom tool menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_extra_custom</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_update</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_setup_extra_custom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up toolbar and welcome view if needed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">TOOLBAR_ON</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">TOOLBAR_ON</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">IsShown</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_toggle_toolbar</span><span class="p">()</span>

        <span class="c1"># Set Custom deafult start page</span>
        <span class="n">welcome_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">WELCOME_PANEL_ON</span>
        <span class="k">if</span> <span class="n">welcome_style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">WELCOME_PANEL_ON</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_welcome_panel</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the layout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Status bar</span>
        <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.gui_statusbar</span> <span class="kn">import</span> <span class="n">StatusBar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sb</span> <span class="o">=</span> <span class="n">StatusBar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetStatusBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">)</span>
        <span class="c1"># Load panels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_panels</span><span class="p">()</span>

<div class="viewcode-block" id="ViewerFrame.SetStatusText"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.SetStatusText">[docs]</a>    <span class="k">def</span> <span class="nf">SetStatusText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="o">.</span><span class="n">get_msg_position</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="n">number</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.PopStatusText"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.PopStatusText">[docs]</a>    <span class="k">def</span> <span class="nf">PopStatusText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="o">.</span><span class="n">get_msg_position</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">PopStatusText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.PushStatusText"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.PushStatusText">[docs]</a>    <span class="k">def</span> <span class="nf">PushStatusText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. todo:: No message is passed. What is this supposed to do?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="o">.</span><span class="n">get_msg_position</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">PushStatusText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span>
                                <span class="n">string</span><span class="o">=</span><span class="s2">&quot;FIXME - PushStatusText called without text&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.add_perspective"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.add_perspective">[docs]</a>    <span class="k">def</span> <span class="nf">add_perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a perspective if it doesn&#39;t already</span>
<span class="sd">        exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_perspectives</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">is_loaded</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">set_batch_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_on</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">plugin</span><span class="o">.</span><span class="n">__class__</span> <span class="o">==</span> <span class="n">item</span><span class="o">.</span><span class="n">__class__</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Plugin </span><span class="si">%s</span><span class="s2"> already loaded&quot;</span> <span class="o">%</span> <span class="n">plugin</span><span class="o">.</span><span class="n">sub_menu</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">is_loaded</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plugin</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Plugin </span><span class="si">%s</span><span class="s2"> appended&quot;</span> <span class="o">%</span> <span class="n">plugin</span><span class="o">.</span><span class="n">sub_menu</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_local_plugins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get plugins local to guiframe and others</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plugins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#import guiframe local plugins</span>
        <span class="c1">#check if the style contain guiframe.dataloader</span>
        <span class="n">style1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">DATALOADER_ON</span>
        <span class="n">style2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">PLOTTING_ON</span>
        <span class="k">if</span> <span class="n">style1</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">DATALOADER_ON</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.local_perspectives.data_loader</span> <span class="kn">import</span> <span class="n">data_loader</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span> <span class="o">=</span> <span class="n">data_loader</span><span class="o">.</span><span class="n">Plugin</span><span class="p">()</span>
                <span class="n">plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;ViewerFrame._get_local_plugins:&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;cannot import dataloader plugin.</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style2</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">PLOTTING_ON</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.local_perspectives.plotting</span> <span class="kn">import</span> <span class="n">plotting</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_plotting_plugin</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">Plugin</span><span class="p">()</span>
                <span class="n">plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plotting_plugin</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;ViewerFrame._get_local_plugins:&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;cannot import plotting plugin.</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plugins</span>

    <span class="k">def</span> <span class="nf">_find_plugins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;perspectives&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find available perspective plug-ins</span>

<span class="sd">        :param dir: directory in which to look for plug-ins</span>

<span class="sd">        :returns: list of plug-ins</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plugins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Go through files in panels directory</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1">## the default panel is the panel is the last plugin added</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
                <span class="n">toks</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">toks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__init__&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">toks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.py&#39;</span> <span class="ow">or</span> <span class="n">toks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">toks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="c1">#check the validity of the module name parsed</span>
                    <span class="c1">#before trying to import it</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="nb">dir</span><span class="p">)]</span>
                    <span class="nb">file</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">toks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                            <span class="n">mod_path</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">dir</span><span class="p">,</span> <span class="n">name</span><span class="p">])</span>
                            <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">mod_path</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span>
                                                <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="n">name</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                            <span class="n">module</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;PLUGIN_ID&quot;</span><span class="p">):</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">plugins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">Plugin</span><span class="p">())</span>
                                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Found plug-in: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">module</span><span class="o">.</span><span class="n">PLUGIN_ID</span>
                                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error accessing PluginPanel&quot;</span>
                                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; in </span><span class="si">%s</span><span class="se">\n</span><span class="s2">  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>
                                <span class="n">config</span><span class="o">.</span><span class="n">printEVT</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;ViewerFrame._find_plugins: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">finally</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">file</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="nb">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># Should raise and catch at a higher level and</span>
            <span class="c1"># display error on status bar</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plugins</span>

    <span class="k">def</span> <span class="nf">_get_panels_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        find the proper size of the current panel</span>
<span class="sd">        get the proper panel width and height</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_client_size</span><span class="p">()</span>
        <span class="c1">## Default size</span>
        <span class="k">if</span> <span class="n">DATAPANEL_WIDTH</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">panel_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">panel_width</span> <span class="o">=</span> <span class="n">DATAPANEL_WIDTH</span>
        <span class="n">panel_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>  <span class="ow">and</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">panel_width</span><span class="p">,</span> <span class="n">panel_height</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s2">&quot;CENTER_PANE&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">CENTER_PANE</span><span class="p">:</span>
            <span class="n">panel_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span> <span class="o">*</span> <span class="mf">0.45</span>
            <span class="k">if</span> <span class="n">CONTROL_WIDTH</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">panel_width</span> <span class="o">=</span> <span class="n">CONTROL_WIDTH</span>
            <span class="k">if</span> <span class="n">CONTROL_HEIGHT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">panel_height</span> <span class="o">=</span> <span class="n">CONTROL_HEIGHT</span>
            <span class="k">return</span> <span class="n">panel_width</span><span class="p">,</span> <span class="n">panel_height</span>
        <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="n">panel_height</span>
        <span class="k">return</span> <span class="n">panel_width</span><span class="p">,</span> <span class="n">panel_height</span>

    <span class="k">def</span> <span class="nf">_load_panels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load all panels in the panels directory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Look for plug-in panels</span>
        <span class="n">panels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERSION_STRING</span> <span class="o">&gt;=</span> <span class="s1">&#39;3.0.0.0&#39;</span><span class="p">:</span>
            <span class="n">mac_pos_y</span> <span class="o">=</span> <span class="mi">85</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mac_pos_y</span> <span class="o">=</span> <span class="mi">40</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;get_panels&quot;</span><span class="p">):</span>
                <span class="n">ps</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_panels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">panels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>

        <span class="c1"># Set up welcome panel</span>
        <span class="c1"># TODO: this needs serious simplification</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">welcome_panel_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">welcome_panel</span> <span class="o">=</span> <span class="n">MDIFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">welcome_panel_class</span><span class="p">(</span><span class="n">welcome_panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">RAISED_BORDER</span><span class="p">)</span>
            <span class="n">welcome_panel</span><span class="o">.</span><span class="n">set_panel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span><span class="o">.</span><span class="n">set_frame</span><span class="p">(</span><span class="n">welcome_panel</span><span class="p">)</span>
            <span class="n">welcome_panel</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span>
        <span class="n">size_t_bar</span> <span class="o">=</span> <span class="mi">70</span>
        <span class="k">if</span> <span class="n">IS_LINUX</span><span class="p">:</span>
            <span class="n">size_t_bar</span> <span class="o">=</span> <span class="mi">115</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_panels_size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_WIN</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">mac_pos_y</span> <span class="o">+</span> <span class="n">size_t_bar</span><span class="p">))</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1">#add data panel</span>
        <span class="n">win</span> <span class="o">=</span> <span class="n">MDIFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
        <span class="n">data_panel</span> <span class="o">=</span> <span class="n">DataPanel</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">win</span><span class="p">,</span> <span class="nb">id</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">win</span><span class="o">.</span><span class="n">set_panel</span><span class="p">(</span><span class="n">data_panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s2">&quot;data_panel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_panel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="o">=</span> <span class="n">data_panel</span>
        <span class="n">d_panel_width</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_panels_size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="p">)</span>
        <span class="n">win</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="n">d_panel_width</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
        <span class="n">is_visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span>
        <span class="k">if</span> <span class="n">IS_WIN</span><span class="p">:</span>
            <span class="n">win</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">win</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">mac_pos_y</span> <span class="o">+</span> <span class="n">size_t_bar</span><span class="p">))</span>
        <span class="n">win</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">is_visible</span><span class="p">)</span>
        <span class="c1"># Add the panels to the AUI manager</span>
        <span class="k">for</span> <span class="n">panel_class</span> <span class="ow">in</span> <span class="n">panels</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">panel_class</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="c1"># Check whether we need to put this panel in the center pane</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">panel_class</span><span class="p">,</span> <span class="s2">&quot;CENTER_PANE&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">panel_class</span><span class="o">.</span><span class="n">CENTER_PANE</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_panels_size</span><span class="p">(</span><span class="n">panel_class</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">panel_class</span><span class="o">.</span><span class="n">CENTER_PANE</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">wx_id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">panel_class</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">pos_y</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetPositionTuple</span><span class="p">()</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">d_panel_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pos_y</span><span class="p">))</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">panel_class</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="p">:</span>
                <span class="n">panel_class</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">is_visible</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">wx_id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">panel_class</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">IS_WIN</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">d_panel_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">d_panel_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mac_pos_y</span> <span class="o">+</span> <span class="n">size_t_bar</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_WIN</span><span class="p">:</span>
            <span class="n">win_height</span> <span class="o">=</span> <span class="n">mac_pos_y</span>
            <span class="k">if</span> <span class="n">IS_LINUX</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERSION_STRING</span> <span class="o">&gt;=</span> <span class="s1">&#39;3.0.0.0&#39;</span><span class="p">:</span>
                    <span class="n">win_height</span> <span class="o">=</span> <span class="n">mac_pos_y</span> <span class="o">+</span> <span class="mi">10</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">win_height</span> <span class="o">=</span> <span class="n">mac_pos_y</span> <span class="o">+</span> <span class="mi">55</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetMaxSize</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">win_height</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="n">win_height</span><span class="p">))</span>

<div class="viewcode-block" id="ViewerFrame.update_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.update_data">[docs]</a>    <span class="k">def</span> <span class="nf">update_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prev_data</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prev_id</span><span class="p">,</span> <span class="n">data_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">update_data</span><span class="p">(</span> \
                              <span class="n">prev_data</span><span class="o">=</span><span class="n">prev_data</span><span class="p">,</span> <span class="n">new_data</span><span class="o">=</span><span class="n">new_data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">remove_by_id</span><span class="p">(</span><span class="n">prev_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">load_data_list</span><span class="p">(</span><span class="n">data_state</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.update_theory"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.update_theory">[docs]</a>    <span class="k">def</span> <span class="nf">update_theory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_id</span><span class="p">,</span> <span class="n">theory</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the theory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">update_theory</span><span class="p">(</span><span class="n">data_id</span><span class="o">=</span><span class="n">data_id</span><span class="p">,</span>
                                                      <span class="n">theory</span><span class="o">=</span><span class="n">theory</span><span class="p">,</span>
                                                      <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">load_data_list</span><span class="p">,</span> <span class="n">data_state</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.onfreeze"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.onfreeze">[docs]</a>    <span class="k">def</span> <span class="nf">onfreeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theory_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves theory/model and passes to data loader.</span>

<span class="sd">        ..warning:: This seems to be the exact same code as the next</span>
<span class="sd">        function called simply freeze. This probably needs fixing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_state_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="n">theory_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">load_data_list</span><span class="p">(</span><span class="nb">list</span><span class="o">=</span><span class="n">data_state_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data_state</span> <span class="ow">in</span> <span class="n">data_state_list</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">new_plot</span> <span class="o">=</span> <span class="n">data_state</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NewPlotEvent</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">new_plot</span><span class="p">,</span>
                                            <span class="n">title</span><span class="o">=</span><span class="n">new_plot</span><span class="o">.</span><span class="n">title</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.freeze"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.freeze">[docs]</a>    <span class="k">def</span> <span class="nf">freeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_id</span><span class="p">,</span> <span class="n">theory_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves theory/model and passes to data loader.</span>

<span class="sd">        ..warning:: This seems to be the exact same code as the next</span>
<span class="sd">        function called simply freeze. This probably needs fixing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_state_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">freeze_theory</span><span class="p">(</span><span class="n">data_id</span><span class="o">=</span><span class="n">data_id</span><span class="p">,</span>
                                                           <span class="n">theory_id</span><span class="o">=</span><span class="n">theory_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">load_data_list</span><span class="p">(</span><span class="nb">list</span><span class="o">=</span><span class="n">data_state_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data_state</span> <span class="ow">in</span> <span class="n">data_state_list</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">new_plot</span> <span class="o">=</span> <span class="n">data_state</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NewPlotEvent</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">new_plot</span><span class="p">,</span>
                                            <span class="n">title</span><span class="o">=</span><span class="n">new_plot</span><span class="o">.</span><span class="n">title</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.delete_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.delete_data">[docs]</a>    <span class="k">def</span> <span class="nf">delete_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">delete_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="ViewerFrame.get_context_menu"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_context_menu">[docs]</a>    <span class="k">def</span> <span class="nf">get_context_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpanel</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the context menu items made available</span>
<span class="sd">        by the different plug-ins.</span>
<span class="sd">        This function is used by the plotting module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plotpanel</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">menu_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="n">menu_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_context_menu</span><span class="p">(</span><span class="n">plotpanel</span><span class="o">=</span><span class="n">plotpanel</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">menu_list</span></div>

<div class="viewcode-block" id="ViewerFrame.get_current_context_menu"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_current_context_menu">[docs]</a>    <span class="k">def</span> <span class="nf">get_current_context_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotpanel</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the context menu items made available</span>
<span class="sd">        by the current plug-in.</span>
<span class="sd">        This function is used by the plotting module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plotpanel</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">menu_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">menu_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_context_menu</span><span class="p">(</span><span class="n">plotpanel</span><span class="o">=</span><span class="n">plotpanel</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">menu_list</span></div>

<div class="viewcode-block" id="ViewerFrame.on_panel_close"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_panel_close">[docs]</a>    <span class="k">def</span> <span class="nf">on_panel_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets called when the close event for a panel runs.</span>
<span class="sd">        This will check which panel has been closed and</span>
<span class="sd">        delete it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">window_name</span> <span class="o">==</span> <span class="n">frame</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disable_app_menu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">[</span><span class="n">ID</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete_panel</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span></div>


<div class="viewcode-block" id="ViewerFrame.popup_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.popup_panel">[docs]</a>    <span class="k">def</span> <span class="nf">popup_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a panel object to the AUI manager</span>

<span class="sd">        :param p: panel object to add to the AUI manager</span>

<span class="sd">        :returns: ID of the event associated with the new panel [int]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ID</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ID</span><span class="p">)]</span> <span class="o">=</span> <span class="n">p</span>
        <span class="c1">## Check and set the size</span>
        <span class="k">if</span> <span class="n">PLOPANEL_WIDTH</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p_panel_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span> <span class="o">*</span> <span class="mf">0.45</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_panel_width</span> <span class="o">=</span> <span class="n">PLOPANEL_WIDTH</span>
        <span class="n">p_panel_height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_panel_width</span> <span class="o">*</span> <span class="mf">0.76</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="n">p_panel_width</span><span class="p">,</span> <span class="n">p_panel_height</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">window_caption</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NOT_SO_GRAPH_LIST</span><span class="p">:</span>
            <span class="n">windowcaption</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">window_caption</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">windowcaption</span> <span class="o">=</span> <span class="s1">&#39;Graph&#39;</span>
        <span class="n">windowname</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">window_name</span>

        <span class="c1"># Append nummber</span>
        <span class="n">captions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_plotpanel_captions</span><span class="p">()</span>
        <span class="c1"># FIXME: Fix this awful loop</span>
        <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">caption</span> <span class="o">=</span> <span class="n">windowcaption</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_num</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">caption</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">captions</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph_num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># protection from forever-loop: max num = 1000</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_num</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">window_caption</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NOT_SO_GRAPH_LIST</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">window_caption</span> <span class="o">=</span> <span class="n">caption</span>
        <span class="n">p</span><span class="o">.</span><span class="n">window_name</span> <span class="o">=</span> <span class="n">windowname</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_num</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">window_caption</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">window_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_WIN</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Center</span><span class="p">()</span>
            <span class="n">x_pos</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">GetPositionTuple</span><span class="p">()</span>
            <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">x_pos</span><span class="p">,</span> <span class="mi">112</span><span class="p">))</span>
        <span class="n">p</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># Register for showing/hiding the panel</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_view</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">group_id</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">=</span> <span class="n">p</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_panel_on_focus</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_plotting_plugin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ind</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">caption</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">GetItems</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">caption</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ID</span></div>

    <span class="k">def</span> <span class="nf">_get_plotpanel_captions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all the plotpanel cations</span>

<span class="sd">        : return: list of captions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">captions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">Id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">captions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">[</span><span class="n">Id</span><span class="p">]</span><span class="o">.</span><span class="n">window_caption</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">captions</span>

    <span class="k">def</span> <span class="nf">_setup_tool_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add toolbar to the frame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span> <span class="o">=</span> <span class="n">GUIToolBar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># The legacy code doesn&#39;t work well for wx 3.0</span>
        <span class="c1"># but the old code produces better results with wx 2.8</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_WIN</span> <span class="ow">and</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERSION_STRING</span> <span class="o">&gt;=</span> <span class="s1">&#39;3.0.0.0&#39;</span><span class="p">:</span>
            <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
            <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetToolBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_toolbar_helper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_toggle_toolbar</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_toolbar_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helping to update the toolbar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">application_name</span> <span class="o">=</span> <span class="s1">&#39;No Selected Analysis&#39;</span>
        <span class="n">panel_name</span> <span class="o">=</span> <span class="s1">&#39;No Panel on Focus&#39;</span>
        <span class="n">c_panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span> <span class="ow">is</span>  <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">c_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_bookmark_menu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">application_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">sub_menu</span>
        <span class="n">c_panel_state</span> <span class="o">=</span> <span class="n">c_panel</span>
        <span class="k">if</span> <span class="n">c_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">panel_name</span> <span class="o">=</span> <span class="n">c_panel</span><span class="o">.</span><span class="n">window_caption</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">c_panel</span><span class="o">.</span><span class="n">IsShownOnScreen</span><span class="p">():</span>
                <span class="n">c_panel_state</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">update_toolbar</span><span class="p">(</span><span class="n">c_panel_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">update_button</span><span class="p">(</span><span class="n">application_name</span><span class="o">=</span><span class="n">application_name</span><span class="p">,</span>
                                    <span class="n">panel_name</span><span class="o">=</span><span class="n">panel_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">Realize</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_menu_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tools menu</span>
<span class="sd">        Go through plug-ins and find tools to populate the tools menu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">CALCULATOR_ON</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">CALCULATOR_ON</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;get_tools&quot;</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">get_tools</span><span class="p">():</span>
                        <span class="c1"># Only create a menu if we have at least one tool</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">tool</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
                        <span class="nb">id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tool</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tool_menu</span><span class="p">,</span> <span class="s1">&#39;&amp;Tools&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_current_plugin_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add current plugin menu</span>
<span class="sd">        Look for plug-in menus</span>
<span class="sd">        Add available plug-in sub-menus.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="bp">None</span> \
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">GetMenuCount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1">#replace or add a new menu for the current plugin</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">FindMenu</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">menu_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">populate_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">menu_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">menu_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_name</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menu_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">populate_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">menu_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">menu_list</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="c1"># Find the Analysis position and insert just after it if possible</span>
                        <span class="n">analysis_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">FindMenu</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">analysis_pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">analysis_pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span> <span class="o">=</span> <span class="n">analysis_pos</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_pos</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_add_help_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add help menu to menu bar.  Includes welcome page, about page,</span>
<span class="sd">        tutorial PDF and documentation pages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Help menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">WELCOME_PANEL_ON</span>

        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Documentation&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onSphinxDocs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_do_tutorial</span> <span class="ow">and</span> <span class="p">(</span><span class="n">IS_WIN</span> <span class="ow">or</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Tutorial&#39;</span><span class="p">,</span> <span class="s1">&#39;Software tutorial&#39;</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onTutorial</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_do_acknowledge</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Acknowledge&#39;</span><span class="p">,</span> <span class="s1">&#39;Acknowledging SasView&#39;</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onAcknowledge</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_do_aboutbox</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ABOUT</span><span class="p">,</span> <span class="s1">&#39;&amp;About&#39;</span><span class="p">,</span> <span class="s1">&#39;Software information&#39;</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ABOUT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onAbout</span><span class="p">)</span>

        <span class="c1"># Checking for updates</span>
        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Check for update&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Check for the latest version of </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">config</span><span class="o">.</span><span class="n">__appname__</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_help_menu</span><span class="p">,</span> <span class="s1">&#39;&amp;Help&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_menu_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add menu items under view menu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">VIEW_MENU</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>

        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="s2">&quot;Display the Grid Window for batch results etc.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Show Grid Window&#39;</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_batch_frame</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span>
        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span>
                                                       <span class="s1">&#39;&amp;Show Data Explorer&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_data_panel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="s1">&#39;Hide Data Explorer&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="s1">&#39;Show Data Explorer&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="n">style1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">TOOLBAR_ON</span>
        <span class="k">if</span> <span class="n">style1</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">TOOLBAR_ON</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Hide Toolbar&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Show Toolbar&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_toggle_toolbar</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">custom_config</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="n">hint_ss</span> <span class="o">=</span> <span class="s2">&quot;Select the current/default configuration &quot;</span>
            <span class="n">hint_ss</span> <span class="o">+=</span> <span class="s2">&quot;as a startup setting&quot;</span>
            <span class="n">preference_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;Startup Setting&#39;</span><span class="p">,</span>
                                                     <span class="n">hint_ss</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_preference_menu</span><span class="p">)</span>

        <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;Category Manager&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit model categories&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_category_manager</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_view_menu</span><span class="p">,</span> <span class="s1">&#39;&amp;View&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="ViewerFrame.show_batch_frame"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.show_batch_frame">[docs]</a>    <span class="k">def</span> <span class="nf">show_batch_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show the grid of result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Show(False) before Show(True) in order to bring it to the front</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_category_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_category_panel">[docs]</a>    <span class="k">def</span>  <span class="nf">on_category_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On cat panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_category_manager</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_on_category_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Category manager frame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">CategoryManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Model Category Manager&#39;</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetIcon</span><span class="p">()</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_preference_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a panel to allow to edit Mask</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.startup_configuration</span> \
        <span class="kn">import</span> <span class="n">StartupConfiguration</span> <span class="k">as</span> <span class="n">ConfDialog</span>

        <span class="n">dialog</span> <span class="o">=</span> <span class="n">ConfDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">gui</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">write_custom_config</span><span class="p">()</span>
            <span class="c1"># post event for info</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Wrote custom configuration&quot;</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">))</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_menu_application</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        # Attach a menu item for each defined perspective or application.</span>
<span class="sd">        # Only add the perspective menu if there are more than one perspectives</span>
<span class="sd">        add menu application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_perspectives</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plug_data_count</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">plug_no_data_count</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">plug</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plug</span><span class="o">.</span><span class="n">get_perspective</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">plug</span><span class="o">.</span><span class="n">use_data</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span><span class="o">.</span><span class="n">InsertCheckItem</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">plug</span><span class="o">.</span><span class="n">sub_menu</span><span class="p">,</span> \
                            <span class="s2">&quot;Switch to analysis: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">plug</span><span class="o">.</span><span class="n">sub_menu</span><span class="p">)</span>
                        <span class="n">plug_data_count</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plug_no_data_count</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span><span class="o">.</span><span class="n">AppendCheckItem</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">plug</span><span class="o">.</span><span class="n">sub_menu</span><span class="p">,</span> \
                            <span class="s2">&quot;Switch to analysis: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">plug</span><span class="o">.</span><span class="n">sub_menu</span><span class="p">)</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">plug</span><span class="o">.</span><span class="n">on_perspective</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">plug_data_count</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">plug_no_data_count</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span><span class="o">.</span><span class="n">RemoveItem</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
            <span class="c1">#Windows introduces a &quot;Window&quot; menu item during the layout process</span>
            <span class="c1">#somehow.  We want it to be next to the last item with Help as</span>
            <span class="c1">#last. However Analysis gets stuck after Window in normal ordering</span>
            <span class="c1">#so force it to be next after the Tools menu item.  Should we add</span>
            <span class="c1">#another menu item will need to check if this is still where we </span>
            <span class="c1">#want Analysis.  This is NOT an issue on the Mac which does not</span>
            <span class="c1">#have the extra Window menu item.</span>
            <span class="c1">#      March 2016 Code Camp  -- PDB </span>
            <span class="n">Tools_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">FindMenu</span><span class="p">(</span><span class="s2">&quot;Tools&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">Tools_pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span><span class="p">,</span>
                                 <span class="s1">&#39;&amp;Analysis&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_applications_menu</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populate_file_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert menu item under file menu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">plugin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plugin</span><span class="o">.</span><span class="n">populate_file_menu</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">plugin</span><span class="o">.</span><span class="n">populate_file_menu</span><span class="p">():</span>
                    <span class="n">m_name</span><span class="p">,</span> <span class="n">m_hint</span><span class="p">,</span> <span class="n">m_handler</span> <span class="o">=</span> <span class="n">item</span>
                    <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="n">m_name</span><span class="p">,</span> <span class="n">m_hint</span><span class="p">)</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="n">m_handler</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>

        <span class="n">style1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MULTIPLE_APPLICATIONS</span>
        <span class="k">if</span> <span class="n">OPEN_SAVE_MENU</span><span class="p">:</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="n">hint_load_file</span> <span class="o">=</span> <span class="s2">&quot;read all analysis states saved previously&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_appl_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Open Project&#39;</span><span class="p">,</span> <span class="n">hint_load_file</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_open_state_project</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">style1</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MULTIPLE_APPLICATIONS</span><span class="p">:</span>
            <span class="c1"># some menu of plugin to be seen under file menu</span>
            <span class="n">hint_load_file</span> <span class="o">=</span> <span class="s2">&quot;Read a status files and load&quot;</span>
            <span class="n">hint_load_file</span> <span class="o">+=</span> <span class="s2">&quot; them into the analysis&quot;</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_appl_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;&amp;Open Analysis&#39;</span><span class="p">,</span> <span class="n">hint_load_file</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_open_state_application</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">OPEN_SAVE_MENU</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Save Project&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Save the state of the whole analysis&#39;</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_save_project</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style1</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MULTIPLE_APPLICATIONS</span><span class="p">:</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_appl_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> \
                <span class="s1">&#39;&amp;Save Analysis&#39;</span><span class="p">,</span> <span class="s1">&#39;Save state of the current active analysis panel&#39;</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_save_application</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">wx_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx_id</span><span class="p">,</span> <span class="s1">&#39;&amp;Quit&#39;</span><span class="p">,</span> <span class="s1">&#39;Exit&#39;</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_menu_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add menu file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># File menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="c1"># Add sub menus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_menu</span><span class="p">,</span> <span class="s1">&#39;&amp;File&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_menu_edit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add menu edit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">EDIT_MENU</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Edit Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">UNDO_ID</span><span class="p">,</span> <span class="s1">&#39;&amp;Undo&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Undo the previous action&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">UNDO_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_undo_panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">REDO_ID</span><span class="p">,</span> <span class="s1">&#39;&amp;Redo&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Redo the previous action&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">REDO_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_redo_panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPY_ID</span><span class="p">,</span> <span class="s1">&#39;&amp;Copy Params&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Copy parameter values&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPY_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_copy_panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PASTE_ID</span><span class="p">,</span> <span class="s1">&#39;&amp;Paste Params&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Paste parameter values&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PASTE_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_paste_panel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu_copyas</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="c1">#Sub menu for Copy As...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu_copyas</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYEX_ID</span><span class="p">,</span> <span class="s1">&#39;Copy current tab to Excel&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;Copy parameter values in tabular format&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYEX_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_copy_panel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu_copyas</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYLAT_ID</span><span class="p">,</span> <span class="s1">&#39;Copy current tab to LaTeX&#39;</span><span class="p">,</span>
                                      <span class="s1">&#39;Copy parameter values in tabular format&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYLAT_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_copy_panel</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">AppendMenu</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYAS_ID</span><span class="p">,</span> <span class="s1">&#39;Copy Params as...&#39;</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu_copyas</span><span class="p">,</span>
                                   <span class="s1">&#39;Copy parameter values in various formats&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PREVIEW_ID</span><span class="p">,</span> <span class="s1">&#39;&amp;Report Results&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Preview current panel&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PREVIEW_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_preview_panel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">RESET_ID</span><span class="p">,</span> <span class="s1">&#39;&amp;Reset Page&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Reset current panel&#39;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">RESET_ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_reset_panel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="p">,</span> <span class="s1">&#39;&amp;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_edit_menu</span><span class="p">()</span>

<div class="viewcode-block" id="ViewerFrame.get_style"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_style">[docs]</a>    <span class="k">def</span> <span class="nf">get_style</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the gui style</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span></div>

    <span class="k">def</span> <span class="nf">_add_menu_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add menu item item data to menu bar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">menu_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span><span class="o">.</span><span class="n">populate_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">menu_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">menu_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_menubar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_toggle_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        hide or show toolbar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s1">&#39;Show Toolbar&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar_menu</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s1">&#39;Hide Toolbar&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">Realize</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_on_status_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display status message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This CallAfter fixes many crashes on MAC.</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="o">.</span><span class="n">set_status</span><span class="p">,</span> <span class="n">evt</span><span class="p">)</span>

<div class="viewcode-block" id="ViewerFrame.on_view"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_view">[docs]</a>    <span class="k">def</span> <span class="nf">on_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A panel was selected to be shown. If it&#39;s not already</span>
<span class="sd">        shown, display it.</span>

<span class="sd">        :param evt: menu event</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">panel_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">evt</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_set_plot_focus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">panel_id</span><span class="p">])</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">CallLater</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">TIME_FACTOR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_schedule</span><span class="p">(</span><span class="bp">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_unfocus</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.show_welcome_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.show_welcome_panel">[docs]</a>    <span class="k">def</span> <span class="nf">show_welcome_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display the welcome panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Show default panel</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_close_welcome_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_close_welcome_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_close_welcome_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close the welcome panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultPanel</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">default_panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span>
        <span class="k">if</span> <span class="n">default_panel</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="n">default_panel</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.delete_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.delete_panel">[docs]</a>    <span class="k">def</span> <span class="nf">delete_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        delete panel given uid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ID</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uid</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">printEVT</span><span class="p">(</span><span class="s2">&quot;delete_panel: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ID</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span> <span class="s2">&quot;connect&quot;</span><span class="p">):</span>
                <span class="n">panel</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plotting_plugin</span><span class="o">.</span><span class="n">delete_panel</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">group_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>

            <span class="c1">#delete uid number not str(uid)</span>
            <span class="k">if</span> <span class="n">ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;delete_panel: No such plot id as </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ID</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.create_gui_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.create_gui_data">[docs]</a>    <span class="k">def</span> <span class="nf">create_gui_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">create_gui_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.get_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extension</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EXTENSIONS</span><span class="p">:</span>
            <span class="n">log_msg</span> <span class="o">=</span> <span class="s2">&quot;File Loader cannot &quot;</span>
            <span class="n">log_msg</span> <span class="o">+=</span> <span class="s2">&quot;load: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
            <span class="n">log_msg</span> <span class="o">+=</span> <span class="s2">&quot;Try Data opening....&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">log_msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1">#reading a state file</span>
        <span class="k">for</span> <span class="n">plug</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="n">reader</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">plug</span><span class="o">.</span><span class="n">get_extensions</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">reader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1">#read the state of the single plugin</span>
                <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="n">ext</span><span class="p">:</span>
                    <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="n">APPLICATION_STATE_EXTENSION</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;DataLoader Error: Encounted Non-ASCII character&quot;</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
                                                       <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;stop&quot;</span><span class="p">))</span>
                        <span class="k">return</span>

        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.load_from_cmd"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.load_from_cmd">[docs]</a>    <span class="k">def</span> <span class="nf">load_from_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        load data from cmd or application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_folder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extension</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EXTENSIONS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.load_state"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.load_state">[docs]</a>    <span class="k">def</span> <span class="nf">load_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">is_project</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        load data from command line or application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">and</span> <span class="p">(</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">APPLICATION_STATE_EXTENSION</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> \
                <span class="ow">and</span> <span class="n">basename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">APPLICATION_STATE_EXTENSION</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">is_project</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span>
                        <span class="n">panel</span><span class="o">.</span><span class="n">on_close</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Completed loading.&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.load_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.load_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        load data from command line</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extension</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">EXTENSIONS</span><span class="p">:</span>
            <span class="n">log_msg</span> <span class="o">=</span> <span class="s2">&quot;Data Loader cannot &quot;</span>
            <span class="n">log_msg</span> <span class="o">+=</span> <span class="s2">&quot;load: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">log_msg</span> <span class="o">+=</span> <span class="s2">&quot;Try File opening ....&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">log_msg</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">log_msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading Data...:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">temp</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_gui_data</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                    <span class="n">output</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_gui_data</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">data_list</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Error while loading&quot;</span>
            <span class="n">error_message</span> <span class="o">+=</span> <span class="s2">&quot; Data from cmd:</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">error_message</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.load_folder"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.load_folder">[docs]</a>    <span class="k">def</span> <span class="nf">load_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load entire folder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="n">file_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span><span class="o">.</span><span class="n">get_file_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_plugin</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Error while loading&quot;</span>
            <span class="n">error_message</span> <span class="o">+=</span> <span class="s2">&quot; Data folder from cmd:</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">error_message</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_on_open_state_application</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Loading Analysis file...&quot;</span><span class="p">))</span>
        <span class="n">plug_wlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_open_state_app_helper</span><span class="p">()</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="s2">&quot;Choose a file&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">plug_wlist</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_open_state_app_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helps &#39;_on_open_state_application()&#39; to find the extension of</span>
<span class="sd">        the current perspective/application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># No current perspective or no extension attr</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PLUGINS_WLIST</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Find the extension of the perspective</span>
            <span class="c1"># and get that as 1st item in list</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">app_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">_extensions</span>
            <span class="n">plug_wlist</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">PLUGINS_WLIST</span>
            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">plug_wlist</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">app_ext</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">ext</span>
                    <span class="k">break</span>
            <span class="c1"># Found the extension</span>
            <span class="k">if</span> <span class="n">ind</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">plug_wlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
                <span class="n">plug_wlist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">plug_wlist</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">plug_wlist</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">plug_wlist</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">plug_wlist</span> <span class="o">=</span> <span class="n">PLUGINS_WLIST</span>

        <span class="k">return</span> <span class="n">plug_wlist</span>

    <span class="k">def</span> <span class="nf">_on_open_state_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Loading Project file...&quot;</span><span class="p">))</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="s2">&quot;Choose a file&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">APPLICATION_WLIST</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">is_project</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_save_application</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save the state of the current active application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Saving Analysis file...&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_save</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Completed saving.&quot;</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error occurred while saving: &quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;To save, the application panel should have a data set..&quot;</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_on_save_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save the state of the SasView as *.svs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span>  <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Saving Project file...&quot;</span><span class="p">))</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="n">APPLICATION_STATE_EXTENSION</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save Project file&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span><span class="p">,</span> <span class="s2">&quot;sasview_proj&quot;</span><span class="p">,</span>
                            <span class="n">extension</span><span class="p">,</span>
                            <span class="n">wx</span><span class="o">.</span><span class="n">SAVE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="c1"># default cansas xml doc</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">save_project</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">temp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">doc</span> <span class="o">=</span> <span class="n">temp</span>

            <span class="c1"># Write the XML document</span>
            <span class="n">extens</span> <span class="o">=</span> <span class="n">APPLICATION_STATE_EXTENSION</span>
            <span class="n">fName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">extens</span>
            <span class="k">if</span> <span class="n">doc</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
                <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">toprettyxml</span><span class="p">())</span>
                <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Completed Saving.&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error occurred while saving the project: &quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;To save, at least one application panel &quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;should have a data set &quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;and model selected. &quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;No project was saved to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error occurred while saving: &quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;To save, at least one application panel &quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;should have a data set..&quot;</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">))</span>

<div class="viewcode-block" id="ViewerFrame.on_save_helper"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_save_helper">[docs]</a>    <span class="k">def</span> <span class="nf">on_save_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">panel</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save state into a file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># case of a panel with multi-pages</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span> <span class="s2">&quot;opened_pages&quot;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">panel</span><span class="o">.</span><span class="n">opened_pages</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                    <span class="c1"># state must be cloned</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">new_doc</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">write_toXML</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">doc</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;firstChild&quot;</span><span class="p">):</span>
                            <span class="n">child</span> <span class="o">=</span> <span class="n">new_doc</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">firstChild</span>
                            <span class="n">doc</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">doc</span> <span class="o">=</span> <span class="n">new_doc</span>
            <span class="c1"># case of only a panel</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">new_doc</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">write_toXML</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">doc</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;firstChild&quot;</span><span class="p">):</span>
                        <span class="n">child</span> <span class="o">=</span> <span class="n">new_doc</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">firstChild</span>
                        <span class="n">doc</span><span class="o">.</span><span class="n">firstChild</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">doc</span> <span class="o">=</span> <span class="n">new_doc</span>
        <span class="k">return</span> <span class="n">doc</span></div>

<div class="viewcode-block" id="ViewerFrame.quit_guiframe"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.quit_guiframe">[docs]</a>    <span class="k">def</span> <span class="nf">quit_guiframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pop up message to make sure the user wants to quit the application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Do you really want to exit this application?        </span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="n">dial</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="s1">&#39;Confirm Exit&#39;</span><span class="p">,</span>
                                <span class="n">wx</span><span class="o">.</span><span class="n">YES_NO</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">YES_DEFAULT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_QUESTION</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dial</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_YES</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="ViewerFrame.WindowClose"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.WindowClose">[docs]</a>    <span class="k">def</span> <span class="nf">WindowClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quit the application from x icon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quit_guiframe</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
            <span class="n">_pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">figs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.Close"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.Close">[docs]</a>    <span class="k">def</span> <span class="nf">Close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quit the application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; --- SasView session was closed --- </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Exit</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_check_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check with the deployment server whether a new version</span>
<span class="sd">        of the application is available.</span>
<span class="sd">        A thread is started for the connecting with the server. The thread calls</span>
<span class="sd">        a call-back method when the current version number has been obtained.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">version_info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.0&quot;</span><span class="p">}</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">__update_URL__</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">UPDATE_TIMEOUT</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># </span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connected to www.sasview.org. Latest version: </span><span class="si">%s</span><span class="s2">&quot;</span>
                             <span class="o">%</span> <span class="p">(</span><span class="n">content</span><span class="p">))</span>
                <span class="n">version_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Failed to connect to www.sasview.org&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_version</span><span class="p">(</span><span class="n">version_info</span><span class="p">,</span> <span class="n">standalone</span><span class="o">=</span><span class="n">event</span> <span class="o">==</span> <span class="bp">None</span><span class="p">)</span>    

        
        
<span class="c1">#         </span>
<span class="c1">#         try:</span>
<span class="c1">#             req = urllib2.Request(config.__update_URL__)</span>
<span class="c1">#             res = urllib2.urlopen(req)</span>
<span class="c1">#             content = res.read().strip()</span>
<span class="c1">#             logging.info(&quot;Connected to www.sasview.org. Latest version: %s&quot;</span>
<span class="c1">#                          % (content))</span>
<span class="c1">#             version_info = json.loads(content)</span>
<span class="c1">#         except:</span>
<span class="c1">#             logging.info(&quot;Failed to connect to www.sasview.org&quot;)</span>
<span class="c1">#             version_info = {&quot;version&quot;: &quot;0.0.0&quot;}</span>
<span class="c1">#         self._process_version(version_info, standalone=event == None)</span>

    <span class="k">def</span> <span class="nf">_process_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version_info</span><span class="p">,</span> <span class="n">standalone</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call-back method for the process of checking for updates.</span>
<span class="sd">        This methods is called by a VersionThread object once the current</span>
<span class="sd">        version number has been obtained. If the check is being done in the</span>
<span class="sd">        background, the user will not be notified unless there&#39;s an update.</span>

<span class="sd">        :param version: version string</span>
<span class="sd">        :param standalone: True of the update is being checked in</span>
<span class="sd">           the background, False otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">version_info</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;0.0.0&quot;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Could not connect to the application server.&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; Please try again later.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Version </span><span class="si">%s</span><span class="s2"> is available! &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">standalone</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">webbrowser</span>
                    <span class="k">if</span> <span class="s2">&quot;download_url&quot;</span> <span class="ow">in</span> <span class="n">version_info</span><span class="p">:</span>
                        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">version_info</span><span class="p">[</span><span class="s2">&quot;download_url&quot;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">__download_page__</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;See the help menu to download it.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">standalone</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;You have the latest version&quot;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">__appname__</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;guiframe: could not get latest application&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; version number</span><span class="se">\n</span><span class="s2">  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">standalone</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Could not connect to the application server.&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; Please try again later.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_onAcknowledge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pop up the acknowledge dialog</span>

<span class="sd">        :param evt: menu event</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_do_acknowledge</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">sas.sasgui.guiframe.acknowledgebox</span> <span class="kn">as</span> <span class="nn">AcknowledgeBox</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">AcknowledgeBox</span><span class="o">.</span><span class="n">DialogAcknowledge</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_onAbout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pop up the about dialog</span>

<span class="sd">        :param evt: menu event</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_do_aboutbox</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">sas.sasgui.guiframe.aboutbox</span> <span class="kn">as</span> <span class="nn">AboutBox</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">AboutBox</span><span class="o">.</span><span class="n">DialogAbout</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_onTutorial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pop up the tutorial dialog</span>

<span class="sd">        :param evt: menu event</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_do_tutorial</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">TUTORIAL_PATH</span>
            <span class="k">if</span> <span class="n">IS_WIN</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.pdfview</span> <span class="kn">import</span> <span class="n">PDFFrame</span>
                    <span class="n">dialog</span> <span class="o">=</span> <span class="n">PDFFrame</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Tutorial&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
                    <span class="c1"># put icon</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">put_icon</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
                    <span class="n">dialog</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error in _onTutorial: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Try an alternate method</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not open the tutorial pdf, trying xhtml2pdf&quot;</span><span class="p">)</span>
                        <span class="kn">from</span> <span class="nn">xhtml2pdf</span> <span class="kn">import</span> <span class="n">pisa</span>
                        <span class="n">pisa</span><span class="o">.</span><span class="n">startViewer</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not open the tutorial pdf with xhtml2pdf&quot;</span><span class="p">)</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;This feature requires &#39;PDF Viewer&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;open &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">path</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Try an alternate method</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not open the tutorial pdf, trying xhtml2pdf&quot;</span><span class="p">)</span>
                        <span class="kn">from</span> <span class="nn">xhtml2pdf</span> <span class="kn">import</span> <span class="n">pisa</span>
                        <span class="n">pisa</span><span class="o">.</span><span class="n">startViewer</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not open the tutorial pdf with xhtml2pdf&quot;</span><span class="p">)</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;This feature requires the &#39;Preview&#39; application</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_onSphinxDocs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bring up Sphinx Documentation at top level whenever the menu item</span>
<span class="sd">        &#39;documentation&#39; is clicked. Calls DocumentationWindow with the top</span>
<span class="sd">        level path of &quot;index.html&quot;</span>

<span class="sd">        :param evt: menu event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Running SasView &quot;in-place&quot; using run.py means the docs will be in a</span>
        <span class="c1"># different place than they would otherwise.</span>
        <span class="kn">from</span> <span class="nn">documentation_window</span> <span class="kn">import</span> <span class="n">DocumentationWindow</span>
        <span class="n">_TreeLocation</span> <span class="o">=</span> <span class="s2">&quot;user/user.html&quot;</span>
        <span class="n">DocumentationWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">_TreeLocation</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;SasView Documentation&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ViewerFrame.set_manager"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_manager">[docs]</a>    <span class="k">def</span> <span class="nf">set_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">manager</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the application manager for this frame</span>

<span class="sd">        :param manager: frame manager</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_manager</span> <span class="o">=</span> <span class="n">manager</span></div>

<div class="viewcode-block" id="ViewerFrame.post_init"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.post_init">[docs]</a>    <span class="k">def</span> <span class="nf">post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This initialization method is called after the GUI</span>
<span class="sd">        has been created and all plug-ins loaded. It calls</span>
<span class="sd">        the post_init() method of each plug-in (if it exists)</span>
<span class="sd">        so that final initialization can be done.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;post_init&quot;</span><span class="p">):</span>
                <span class="n">item</span><span class="o">.</span><span class="n">post_init</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.set_perspective"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_perspective">[docs]</a>    <span class="k">def</span> <span class="nf">set_perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panels</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the perspective of the GUI.</span>
<span class="sd">        Opens all the panels in the list, and closes</span>
<span class="sd">        all the others.</span>

<span class="sd">        :param panels: list of panels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># Check whether this is a sticky panel</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="s2">&quot;ALWAYS_ON&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">ALWAYS_ON</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">window_name</span> <span class="ow">in</span> <span class="n">panels</span><span class="p">:</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># always show the data panel if enable</span>
                <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;data_panel&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s1">&#39;data_panel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">frame</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">()</span>
                        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">frame</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
                        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.show_data_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.show_data_panel">[docs]</a>    <span class="k">def</span> <span class="nf">show_data_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show the data panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span><span class="o">.</span><span class="n">GetText</span><span class="p">()</span>
        <span class="n">pane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s2">&quot;data_panel&quot;</span><span class="p">]</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">pane</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;Show Data Explorer&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">|</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="s1">&#39;Hide Data Explorer&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel_menu</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="s1">&#39;Show Data Explorer&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.add_data_helper"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.add_data_helper">[docs]</a>    <span class="k">def</span> <span class="nf">add_data_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.add_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.add_data">[docs]</a>    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        receive a dictionary of data from loader</span>
<span class="sd">        store them its data manager if possible</span>
<span class="sd">        send to data the current active perspective if the data panel</span>
<span class="sd">        is not active.</span>
<span class="sd">        :param data_list: dictionary of data&#39;s ID and value Data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Store data into manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_data_helper</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
        <span class="c1"># set data in the data panel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_data_state</span><span class="p">(</span><span class="n">data_list</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">load_data_list</span><span class="p">(</span><span class="n">data_state</span><span class="p">)</span>
        <span class="c1">#if the data panel is shown wait for the user to press a button</span>
        <span class="c1">#to send data to the current perspective. if the panel is not</span>
        <span class="c1">#show  automatically send the data to the current perspective</span>
        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gui_style</span> <span class="o">&amp;</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GUIFRAME</span><span class="o">.</span><span class="n">MANAGER_ON</span><span class="p">:</span>
            <span class="c1">#wait for button press from the data panel to set_data</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#automatically send that to the current perspective</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_id</span><span class="o">=</span><span class="n">data_list</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

<div class="viewcode-block" id="ViewerFrame.set_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_id</span><span class="p">,</span> <span class="n">theory_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set data to current perspective</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">data_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">list_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Guiframe does not have a current perspective&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.set_theory"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_theory">[docs]</a>    <span class="k">def</span> <span class="nf">set_theory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_id</span><span class="p">,</span> <span class="n">theory_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">list_theory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">theory_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">set_theory</span><span class="p">(</span><span class="n">list_theory</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Guiframe set_theory: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Guiframe does not have a current perspective&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.plot_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.plot_data">[docs]</a>    <span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_id</span><span class="p">,</span> <span class="n">data_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">theory_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        send a list of data to plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_list</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">data_id</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">temp_list_theory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">theory_id</span><span class="p">)</span>
        <span class="n">total_plot_list</span> <span class="o">=</span> <span class="n">data_list</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp_list_theory</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">theory_data</span><span class="p">,</span> <span class="n">theory_state</span> <span class="o">=</span> <span class="n">item</span>
            <span class="n">total_plot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theory_data</span><span class="p">)</span>
        <span class="n">GROUP_ID</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">new_plot</span> <span class="ow">in</span> <span class="n">total_plot_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;cannot append plot. No plot panel on focus!&quot;</span>
                    <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;please click on any available plot to set focus&quot;</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">message</span><span class="p">,</span>
                                                   <span class="n">info</span><span class="o">=</span><span class="s1">&#39;warning&#39;</span><span class="p">))</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_add_data</span><span class="p">(</span><span class="n">new_plot</span><span class="p">):</span>
                        <span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">group_id</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Only 1D Data can be append to&quot;</span>
                        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot; plot panel containing 1D data.</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not be appended.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;try new plot option.</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">message</span><span class="p">,</span>
                                                       <span class="n">info</span><span class="o">=</span><span class="s1">&#39;warning&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#if not append then new plot</span>
                <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.dataFitting</span> <span class="kn">import</span> <span class="n">Data2D</span>
                <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">Data2D</span><span class="p">,</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">__class__</span><span class="p">):</span>
                    <span class="c1">#for 2 D always plot in a separated new plot</span>
                    <span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># plot all 1D in a new plot</span>
                    <span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span> <span class="o">=</span> <span class="n">GROUP_ID</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;PLOT &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_plot</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NewPlotEvent</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">new_plot</span><span class="p">,</span>
                                            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                            <span class="n">group_id</span><span class="o">=</span><span class="n">new_plot</span><span class="o">.</span><span class="n">group_id</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.remove_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.remove_data">[docs]</a>    <span class="k">def</span> <span class="nf">remove_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_id</span><span class="p">,</span> <span class="n">theory_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete data state if data_id is provide</span>
<span class="sd">        delete theory created with data of id data_id if theory_id is provide</span>
<span class="sd">        if delete all true: delete the all state</span>
<span class="sd">        else delete theory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data_id</span> <span class="o">+</span> <span class="n">theory_id</span>
        <span class="k">for</span> <span class="n">plug</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugins</span><span class="p">:</span>
            <span class="n">plug</span><span class="o">.</span><span class="n">delete_data</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">data_list</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">data_id</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">temp_list_theory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">theory_id</span><span class="p">)</span>
        <span class="n">total_plot_list</span> <span class="o">=</span> <span class="n">data_list</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp_list_theory</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">theory_data</span><span class="p">,</span> <span class="n">theory_state</span> <span class="o">=</span> <span class="n">item</span>
            <span class="n">total_plot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theory_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">new_plot</span> <span class="ow">in</span> <span class="n">total_plot_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">group_id</span> <span class="ow">in</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">list_group_id</span><span class="p">:</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NewPlotEvent</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">new_plot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                                <span class="n">group_id</span><span class="o">=</span><span class="n">group_id</span><span class="p">,</span>
                                                <span class="n">action</span><span class="o">=</span><span class="s1">&#39;remove&#39;</span><span class="p">))</span>
                <span class="c1">#remove res plot: Todo: improve</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_remove_res_plot</span><span class="p">,</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_manager</span><span class="o">.</span><span class="n">delete_data</span><span class="p">(</span><span class="n">data_id</span><span class="o">=</span><span class="n">data_id</span><span class="p">,</span>
                                       <span class="n">theory_id</span><span class="o">=</span><span class="n">theory_id</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_remove_res_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Try to remove corresponding res plot</span>

<span class="sd">        : param id: id of the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NewPlotEvent</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;res&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span>
                                            <span class="n">group_id</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;res&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span>
                                            <span class="n">action</span><span class="o">=</span><span class="s1">&#39;remove&#39;</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>

<div class="viewcode-block" id="ViewerFrame.save_data1d"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.save_data1d">[docs]</a>    <span class="k">def</span> <span class="nf">save_data1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save data dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="n">fname</span>
        <span class="n">wildcard</span> <span class="o">=</span> <span class="s2">&quot;Text files (*.txt)|*.txt|&quot;</span>\
                    <span class="s2">&quot;CanSAS 1D files(*.xml)|*.xml&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose a file&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span><span class="p">,</span>
                            <span class="n">default_name</span><span class="p">,</span> <span class="n">wildcard</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">SAVE</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="c1"># ext_num = 0 for .txt, ext_num = 1 for .xml</span>
            <span class="c1"># This is MAC Fix</span>
            <span class="n">ext_num</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetFilterIndex</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ext_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ext_format</span> <span class="o">=</span> <span class="s1">&#39;.txt&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ext_format</span> <span class="o">=</span> <span class="s1">&#39;.xml&#39;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ext_format</span>
            <span class="n">mypath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="c1">#Instantiate a loader</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="n">Loader</span><span class="p">()</span>
            <span class="n">ext_format</span> <span class="o">=</span> <span class="s2">&quot;.txt&quot;</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">mypath</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">ext_format</span><span class="p">:</span>
                <span class="c1"># Make sure the ext included in the file name</span>
                <span class="c1"># especially on MAC</span>
                <span class="n">fName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ext_format</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_onsaveTXT</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fName</span><span class="p">)</span>
            <span class="n">ext_format</span> <span class="o">=</span> <span class="s2">&quot;.xml&quot;</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">mypath</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">ext_format</span><span class="p">:</span>
                <span class="c1"># Make sure the ext included in the file name</span>
                <span class="c1"># especially on MAC</span>
                <span class="n">fName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ext_format</span>
                <span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ext_format</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_onsaveTXT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save file as txt</span>

<span class="sd">        .. todo:: Refactor and remove this method. See &#39;TODO&#39; in _onSave.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">has_errors</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dy</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">dy</span> <span class="o">==</span> <span class="p">[]:</span>
                <span class="n">has_errors</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="c1"># Sanity check</span>
            <span class="k">if</span> <span class="n">has_errors</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">):</span>
                        <span class="n">has_errors</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">has_errors</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">has_errors</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dx</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">dx</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&lt;X&gt;   &lt;Y&gt;   &lt;dY&gt;   &lt;dX&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&lt;X&gt;   &lt;Y&gt;   &lt;dY&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&lt;X&gt;   &lt;Y&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">has_errors</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dx</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">dx</span> <span class="o">!=</span> <span class="p">[]:</span>
                        <span class="k">if</span>  <span class="n">data</span><span class="o">.</span><span class="n">dx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                            <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                            <span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                            <span class="n">data</span><span class="o">.</span><span class="n">dx</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                        <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                        <span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                    <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                    <span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">  </span><span class="si">%g</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                            <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="ViewerFrame.show_data1d"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.show_data1d">[docs]</a>    <span class="k">def</span> <span class="nf">show_data1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show data dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Unable to find min/max of </span><span class="se">\n</span><span class="s2"> data named </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> \
                        <span class="n">data</span><span class="o">.</span><span class="n">filename</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
                                           <span class="n">info</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">msg</span>
        <span class="c1">## text = str(data)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">__str__</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;Data Min Max:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;X_min = </span><span class="si">%s</span><span class="s1">:  X_max = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;Y_min = </span><span class="si">%s</span><span class="s1">:  Y_max = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dy</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;dY_min = </span><span class="si">%s</span><span class="s1">:  dY_max = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Data Points:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">x_st</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dy</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">:</span>
                <span class="n">dy_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dy</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dy_val</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dx</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">:</span>
                <span class="n">dx_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dx</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dx_val</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dxl</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dxl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">x_st</span> <span class="o">=</span> <span class="s2">&quot;Xl&quot;</span>
                <span class="n">dx_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dxl</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">dxw</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dxw</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">x_st</span> <span class="o">=</span> <span class="s2">&quot;Xw&quot;</span>
                <span class="n">dx_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dxw</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;index&gt; </span><span class="se">\t</span><span class="s2">&lt;X&gt; </span><span class="se">\t</span><span class="s2">&lt;Y&gt; </span><span class="se">\t</span><span class="s2">&lt;dY&gt; </span><span class="se">\t</span><span class="s2">&lt;d</span><span class="si">%s</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x_st</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span>
                                                  <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                                                  <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
                                                  <span class="n">dy_val</span><span class="p">,</span>
                                                  <span class="n">dx_val</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">pdfview</span> <span class="kn">import</span> <span class="n">TextFrame</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">TextFrame</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Data Info: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="c1"># put icon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put_icon</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.save_data2d"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.save_data2d">[docs]</a>    <span class="k">def</span> <span class="nf">save_data2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save data2d dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="n">fname</span>
        <span class="n">wildcard</span> <span class="o">=</span> <span class="s2">&quot;IGOR/DAT 2D file in Q_map (*.dat)|*.DAT&quot;</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose a file&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span><span class="p">,</span>
                            <span class="n">default_name</span><span class="p">,</span> <span class="n">wildcard</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">SAVE</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="c1"># ext_num = 0 for .txt, ext_num = 1 for .xml</span>
            <span class="c1"># This is MAC Fix</span>
            <span class="n">ext_num</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetFilterIndex</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ext_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ext_format</span> <span class="o">=</span> <span class="s1">&#39;.dat&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ext_format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ext_format</span>
            <span class="n">mypath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="c1">#Instantiate a loader</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="n">Loader</span><span class="p">()</span>

            <span class="n">ext_format</span> <span class="o">=</span> <span class="s2">&quot;.dat&quot;</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">mypath</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">ext_format</span><span class="p">:</span>
                <span class="c1"># Make sure the ext included in the file name</span>
                <span class="c1"># especially on MAC</span>
                <span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ext_format</span>
                <span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ext_format</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_save_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewerFrame.show_data2d"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.show_data2d">[docs]</a>    <span class="k">def</span> <span class="nf">show_data2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show data dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Gathering Data2D Info.&quot;</span><span class="p">,</span>
                                       <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">__str__</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;Data Min Max:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;I_min = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;I_max = </span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;Data (First 2501) Points:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;Data columns include err(I).</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;ASCII data starts here.</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;index&gt; </span><span class="se">\t</span><span class="s2">&lt;Qx&gt; </span><span class="se">\t</span><span class="s2">&lt;Qy&gt; </span><span class="se">\t</span><span class="s2">&lt;I&gt; </span><span class="se">\t</span><span class="s2">&lt;dI&gt; </span><span class="se">\t</span><span class="s2">&lt;dQparal&gt; </span><span class="se">\t</span><span class="s2">&lt;dQperp&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">di_val</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">dx_val</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">dy_val</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">len_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">qx_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_data</span><span class="p">):</span>
            <span class="n">x_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">qx_data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">y_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">qy_data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">i_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">err_data</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">di_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">err_data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dqx_data</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dx_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dqx_data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dqy_data</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">dy_val</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dqy_data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="s2"> </span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span>
                                                            <span class="n">x_val</span><span class="p">,</span>
                                                            <span class="n">y_val</span><span class="p">,</span>
                                                            <span class="n">i_val</span><span class="p">,</span>
                                                            <span class="n">di_val</span><span class="p">,</span>
                                                            <span class="n">dx_val</span><span class="p">,</span>
                                                            <span class="n">dy_val</span><span class="p">)</span>
            <span class="c1"># Takes too long time for typical data2d: Break here</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">2500</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;.............</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">break</span>

        <span class="kn">from</span> <span class="nn">pdfview</span> <span class="kn">import</span> <span class="n">TextFrame</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">TextFrame</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Data Info: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="c1"># put icon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put_icon</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;Data2D Info Displayed&quot;</span><span class="p">,</span>
                                       <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;stop&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewerFrame.set_current_perspective"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_current_perspective">[docs]</a>    <span class="k">def</span> <span class="nf">set_current_perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perspective</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the current active perspective</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="o">=</span> <span class="n">perspective</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;No current analysis selected&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_current_plugin_menu</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span> <span class="s1">&#39;CENTER_PANE&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">panel</span><span class="o">.</span><span class="n">CENTER_PANE</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">get_perspective</span><span class="p">():</span>
                        <span class="n">frame</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">frame</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">panel</span><span class="o">.</span><span class="n">window_name</span><span class="p">:</span>
                                <span class="n">panel</span><span class="o">.</span><span class="n">on_set_focus</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
                                <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">sub_menu</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">set_active_perspective</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_check_applications_menu</span><span class="p">()</span>
            <span class="c1">#Set the SasView title</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_title_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_set_title_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the SasView title w/ the current application name</span>

<span class="sd">        : param name: application name [string]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set SanView Window title w/ application anme</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;  - &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; -&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_applications_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        check the menu of the current application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">menu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applications_menu</span><span class="o">.</span><span class="n">GetMenuItems</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_perspective</span><span class="o">.</span><span class="n">sub_menu</span>
                    <span class="k">if</span> <span class="n">menu</span><span class="o">.</span><span class="n">IsCheckable</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">menu</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                            <span class="n">menu</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">menu</span><span class="o">.</span><span class="n">Check</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<div class="viewcode-block" id="ViewerFrame.enable_add_data"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_add_data">[docs]</a>    <span class="k">def</span> <span class="nf">enable_add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_plot</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enable append data on a plot panel</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotting_plugin</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">is_theory</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">plots</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;Theory1D&quot;</span>

        <span class="n">is_data2d</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">new_plot</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

        <span class="n">is_data1d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;ModelPanel1D&quot;</span>\
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="o">.</span><span class="n">group_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="n">has_meta_data</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">new_plot</span><span class="p">,</span> <span class="s1">&#39;meta_data&#39;</span><span class="p">)</span>

        <span class="c1">#disable_add_data if the data is being recovered from  a saved state file.</span>
        <span class="n">is_state_data</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">has_meta_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;invstate&#39;</span> <span class="ow">in</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">meta_data</span><span class="p">:</span>
                <span class="n">is_state_data</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span>  <span class="s1">&#39;prstate&#39;</span> <span class="ow">in</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">meta_data</span><span class="p">:</span>
                <span class="n">is_state_data</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span>  <span class="s1">&#39;fitstate&#39;</span> <span class="ow">in</span> <span class="n">new_plot</span><span class="o">.</span><span class="n">meta_data</span><span class="p">:</span>
                <span class="n">is_state_data</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">return</span> <span class="n">is_data1d</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_data2d</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_theory</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_state_data</span></div>

<div class="viewcode-block" id="ViewerFrame.check_multimode"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.check_multimode">[docs]</a>    <span class="k">def</span> <span class="nf">check_multimode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perspective</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check the perspective have batch mode capablitity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">perspective</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">perspective</span><span class="o">.</span><span class="n">get_batch_capable</span><span class="p">()</span>
        <span class="n">flag_on</span> <span class="o">=</span> <span class="n">perspective</span><span class="o">.</span><span class="n">batch_on</span>
        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">rb_single_mode</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="ow">not</span> <span class="n">flag_on</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">rb_batch_mode</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">flag_on</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">rb_single_mode</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">rb_batch_mode</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">rb_single_mode</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_panel</span><span class="o">.</span><span class="n">rb_batch_mode</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_edit_menu"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_edit_menu">[docs]</a>    <span class="k">def</span> <span class="nf">enable_edit_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        enable menu item under edit menu depending on the panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_undo_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">UNDO_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_redo_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">REDO_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_copy_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPY_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_paste_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PASTE_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

            <span class="c1">#Copy menu</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_copy_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu_copyas</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYEX_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu_copyas</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPYLAT_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_preview_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PREVIEW_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">get_reset_flag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">RESET_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">UNDO_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">REDO_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">COPY_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PASTE_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">PREVIEW_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edit_menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">GUIFRAME_ID</span><span class="o">.</span><span class="n">RESET_ID</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_undo_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_undo_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_undo_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        undo previous action of the last panel on focus if possible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_undo</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_redo_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_redo_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_redo_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        redo the last cancel action done on the last panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_redo</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_copy_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_copy_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_copy_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        copy the last panel on focus if possible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_copy</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_paste_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_paste_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_paste_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        paste clipboard to the last panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_paste</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_bookmark_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_bookmark_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_bookmark_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        bookmark panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_bookmark</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.append_bookmark"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.append_bookmark">[docs]</a>    <span class="k">def</span> <span class="nf">append_bookmark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bookmark available information of the panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">append_bookmark</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_save_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_save_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_save_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save possible information on the current panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_save</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_preview_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_preview_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_preview_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        preview information on the panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_preview</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_print_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_print_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_print_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        print available information on the last panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_print</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_zoom_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_zoom_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_zoom_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zoom on the current panel if possible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_zoom</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_zoom_in_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_zoom_in_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_zoom_in_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zoom in of the panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_zoom_in</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_zoom_out_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_zoom_out_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_zoom_out_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zoom out on the panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_zoom_out</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_drag_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_drag_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_drag_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        drag apply to the panel on focus</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_drag</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_reset_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_reset_panel">[docs]</a>    <span class="k">def</span> <span class="nf">on_reset_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reset the current panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="o">.</span><span class="n">on_reset</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.on_change_caption"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_change_caption">[docs]</a>    <span class="k">def</span> <span class="nf">on_change_caption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">old_caption</span><span class="p">,</span> <span class="n">new_caption</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the panel caption</span>

<span class="sd">        :param name: window_name of the pane</span>
<span class="sd">        :param old_caption: current caption [string]</span>
<span class="sd">        :param new_caption: new caption [string]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># wx.aui.AuiPaneInfo</span>
        <span class="n">pane_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paneinfo</span><span class="p">(</span><span class="n">old_caption</span><span class="p">)</span>
        <span class="c1"># update the data_panel.cb_plotpanel</span>
        <span class="k">if</span> <span class="s1">&#39;data_panel&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># remove from data_panel combobox</span>
            <span class="n">data_panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panels</span><span class="p">[</span><span class="s2">&quot;data_panel&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># Check if any panel has the same caption</span>
                <span class="n">has_newstring</span> <span class="o">=</span> <span class="n">data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">FindString</span>\
                                                            <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_caption</span><span class="p">))</span>
                <span class="n">caption</span> <span class="o">=</span> <span class="n">new_caption</span>
                <span class="k">if</span> <span class="n">has_newstring</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">:</span>
                    <span class="n">captions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_plotpanel_captions</span><span class="p">()</span>
                    <span class="c1"># Append nummber</span>
                    <span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="c1"># FIXME: fix this terrible loop</span>
                    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">caption</span> <span class="o">=</span> <span class="n">new_caption</span> <span class="o">+</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">caption</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">captions</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="n">inc</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># notify to users</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Found Same Title: Added &#39;_</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StatusEvent</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">msg</span><span class="p">))</span>
                <span class="c1"># update data_panel cb</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">old_caption</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">NOT_FOUND</span><span class="p">:</span>
                    <span class="n">data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">SetString</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>
                    <span class="n">data_panel</span><span class="o">.</span><span class="n">cb_plotpanel</span><span class="o">.</span><span class="n">SetStringSelection</span><span class="p">(</span><span class="n">caption</span><span class="p">)</span>
        <span class="c1"># New Caption</span>
        <span class="n">pane_info</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">caption</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">caption</span></div>

<div class="viewcode-block" id="ViewerFrame.get_paneinfo"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_paneinfo">[docs]</a>    <span class="k">def</span> <span class="nf">get_paneinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get pane Caption from window_name</span>

<span class="sd">        :param name: window_name in AuiPaneInfo</span>
<span class="sd">        :returns: AuiPaneInfo of the name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">panel</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">GetTitle</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">panel</span><span class="o">.</span><span class="n">frame</span>
        <span class="k">return</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_undo"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_undo">[docs]</a>    <span class="k">def</span> <span class="nf">enable_undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        enable undo related control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_undo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_redo"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_redo">[docs]</a>    <span class="k">def</span> <span class="nf">enable_redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        enable redo</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_redo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_copy"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_copy">[docs]</a>    <span class="k">def</span> <span class="nf">enable_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        enable copy related control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_paste"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_paste">[docs]</a>    <span class="k">def</span> <span class="nf">enable_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        enable paste</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_paste</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_bookmark"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_bookmark">[docs]</a>    <span class="k">def</span> <span class="nf">enable_bookmark</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bookmark</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_bookmark</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_save"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_save">[docs]</a>    <span class="k">def</span> <span class="nf">enable_save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_preview"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_preview">[docs]</a>    <span class="k">def</span> <span class="nf">enable_preview</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        preview</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_preview</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_print"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_print">[docs]</a>    <span class="k">def</span> <span class="nf">enable_print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        print</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_zoom"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_zoom">[docs]</a>    <span class="k">def</span> <span class="nf">enable_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zoom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_zoom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_zoom_in"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_zoom_in">[docs]</a>    <span class="k">def</span> <span class="nf">enable_zoom_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zoom in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_zoom_in</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_zoom_out"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_zoom_out">[docs]</a>    <span class="k">def</span> <span class="nf">enable_zoom_out</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zoom out</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_zoom_out</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.enable_drag"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_drag">[docs]</a>    <span class="k">def</span> <span class="nf">enable_drag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        drag</span>
<span class="sd">        &quot;&quot;&quot;</span></div>
        <span class="c1">#Not implemeted</span>

<div class="viewcode-block" id="ViewerFrame.enable_reset"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.enable_reset">[docs]</a>    <span class="k">def</span> <span class="nf">enable_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reset the current panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpanel_on_focus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">enable_reset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.get_toolbar_height"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_toolbar_height">[docs]</a>    <span class="k">def</span> <span class="nf">get_toolbar_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetToolBar</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetToolBar</span><span class="p">()</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_LINUX</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">size_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetToolBar</span><span class="p">()</span><span class="o">.</span><span class="n">GetSizeTuple</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">size_y</span></div>

<div class="viewcode-block" id="ViewerFrame.set_schedule_full_draw"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_schedule_full_draw">[docs]</a>    <span class="k">def</span> <span class="nf">set_schedule_full_draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s1">&#39;del&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add/subtract the schedule full draw list with the panel given</span>

<span class="sd">        :param panel: plot panel</span>
<span class="sd">        :param func: append or del [string]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># append this panel in the schedule list if not in yet</span>
        <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;append&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="c1"># remove this panel from schedule list</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;del&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>

        <span class="c1"># reset the schdule</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="ViewerFrame.full_draw"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.full_draw">[docs]</a>    <span class="k">def</span> <span class="nf">full_draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the panels with axes in the schedule to full dwar list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">)</span>
        <span class="c1">#if not self.schedule:</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_schedule</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># if any of the panel is shown do full_draw</span>
            <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">:</span>
                <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">panel</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
                    <span class="k">break</span>
                <span class="c1"># otherwise, return</span>
                <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="n">count</span><span class="p">:</span>
                    <span class="k">return</span>
        <span class="c1">#Simple redraw only for a panel shown</span>
        <span class="k">def</span> <span class="nf">f_draw</span><span class="p">(</span><span class="n">panel</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Draw A panel in the full draw list</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># This checking of GetCapture is to stop redrawing</span>
                <span class="c1"># while any panel is capture.</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">frame</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetCapture</span><span class="p">():</span>
                    <span class="c1"># draw if possible</span>
                    <span class="n">panel</span><span class="o">.</span><span class="n">set_resizing</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                    <span class="c1">#panel.Show(True)</span>
                    <span class="n">panel</span><span class="o">.</span><span class="n">draw_plot</span><span class="p">()</span>
                <span class="c1"># Check if the panel is not shown</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">()</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Draw all panels</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">f_draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">map</span><span class="p">(</span><span class="n">f_draw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">)</span>
        <span class="c1"># Reset the attr</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule_full_draw_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_schedule</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_schedule</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.set_schedule"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_schedule">[docs]</a>    <span class="k">def</span> <span class="nf">set_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set schedule</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">schedule</span></div>

<div class="viewcode-block" id="ViewerFrame.get_schedule"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_schedule">[docs]</a>    <span class="k">def</span> <span class="nf">get_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get schedule</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span></div>

<div class="viewcode-block" id="ViewerFrame.on_set_plot_focus"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.on_set_plot_focus">[docs]</a>    <span class="k">def</span> <span class="nf">on_set_plot_focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set focus on a plot panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">panel</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1">#self.set_plot_unfocus()</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">on_set_focus</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="c1"># set focusing panel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">=</span> <span class="n">panel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_panel_on_focus</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.set_plot_unfocus"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.set_plot_unfocus">[docs]</a>    <span class="k">def</span> <span class="nf">set_plot_unfocus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Un focus all plot panels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_panels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">plot</span><span class="o">.</span><span class="n">on_kill_focus</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewerFrame.get_window_size"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.ViewerFrame.get_window_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get window size</span>

<span class="sd">        :returns: size</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSizeTuple</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_WIN</span><span class="p">:</span>
            <span class="c1"># Subtract toolbar height to get real window side</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toolbar</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
                <span class="n">height</span> <span class="o">-=</span> <span class="mi">45</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_onDrawIdle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ReDraw with axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># check if it is time to redraw</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCapture</span><span class="p">()</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># Draw plot, changes resizing too</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_draw</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># restart idle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redraw_idle</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_redraw_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restart Idle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># restart idle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idletimer</span><span class="o">.</span><span class="n">Restart</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">TIME_FACTOR</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="DefaultPanel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.DefaultPanel">[docs]</a><span class="k">class</span> <span class="nc">DefaultPanel</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">,</span> <span class="n">PanelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the API for a panels to work with</span>
<span class="sd">    the GUI manager</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## Internal nickname for the window, used by the AUI manager</span>
    <span class="n">window_name</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
    <span class="c1">## Name to appear on the window title bar</span>
    <span class="n">window_caption</span> <span class="o">=</span> <span class="s2">&quot;Welcome panel&quot;</span>
    <span class="c1">## Flag to tell the AUI manager to put this panel in the center pane</span>
    <span class="n">CENTER_PANE</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="n">PanelBase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span></div>



<div class="viewcode-block" id="SasViewApp"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp">[docs]</a><span class="k">class</span> <span class="nc">SasViewApp</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SasView application</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SasViewApp.OnInit"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.OnInit">[docs]</a>    <span class="k">def</span> <span class="nf">OnInit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When initialised</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_placement</span><span class="p">((</span><span class="n">GUIFRAME_WIDTH</span><span class="p">,</span>
                                                        <span class="n">GUIFRAME_HEIGHT</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">ViewerFrame</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                 <span class="n">title</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">,</span>
                                 <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                                 <span class="n">gui_style</span><span class="o">=</span><span class="n">DEFAULT_STYLE</span><span class="p">,</span>
                                 <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_WIN</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">EnableCloseButton</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_screen</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> Could not load &quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">APPLICATION_NAME</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;input file from command line.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Display a splash screen on top of the frame.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">SPLASH_SCREEN_PATH</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s_screen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_splash_screen</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                                           <span class="n">path</span><span class="o">=</span><span class="n">SPLASH_SCREEN_PATH</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_screen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s_screen</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Cannot display splash screen</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetTopWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="SasViewApp.maximize_win"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.maximize_win">[docs]</a>    <span class="k">def</span> <span class="nf">maximize_win</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maximize the window after the frame shown</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_max</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
                <span class="c1"># Max window size</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_max</span><span class="p">)</span></div>

<div class="viewcode-block" id="SasViewApp.open_file"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.open_file">[docs]</a>    <span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        open a state file at the start of the application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_file</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">app_base</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">APPLICATION_NAME</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span> <span class="ow">or</span> <span class="n">basename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">app_base</span><span class="p">:</span>
                <span class="n">app_py</span> <span class="o">=</span> <span class="n">app_base</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
                <span class="n">app_exe</span> <span class="o">=</span> <span class="n">app_base</span> <span class="o">+</span> <span class="s1">&#39;.exe&#39;</span>
                <span class="n">app_app</span> <span class="o">=</span> <span class="n">app_base</span> <span class="o">+</span> <span class="s1">&#39;.app&#39;</span>
                <span class="k">if</span> <span class="n">basename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="n">app_py</span><span class="p">,</span> <span class="n">app_exe</span><span class="p">,</span> <span class="n">app_app</span><span class="p">,</span> <span class="n">app_base</span><span class="p">]:</span>
                    <span class="n">data_base</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">input_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATAPATH</span><span class="p">,</span>
                                                               <span class="n">data_base</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">input_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">set_input_file</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="n">input_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="SasViewApp.clean_plugin_models"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.clean_plugin_models">[docs]</a>    <span class="k">def</span> <span class="nf">clean_plugin_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete plugin models  in app folder</span>

<span class="sd">        :param path: path of the plugin_models folder in app</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># do it only the first time app loaded</span>
        <span class="c1"># delete unused model folder</span>
        <span class="n">model_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_APP</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_folder</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_folder</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">model_folder</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">model_folder</span><span class="p">):</span>
                        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;gui_manager.clean_plugin_models:</span><span class="se">\n</span><span class="s2">  </span><span class="si">%s</span><span class="s2">&quot;</span> \
                                  <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_value</span><span class="p">)</span></div>

<div class="viewcode-block" id="SasViewApp.set_manager"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.set_manager">[docs]</a>    <span class="k">def</span> <span class="nf">set_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">manager</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a reference to the application manager</span>
<span class="sd">        of the GUI manager (Frame)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">set_manager</span><span class="p">(</span><span class="n">manager</span><span class="p">)</span></div>

<div class="viewcode-block" id="SasViewApp.build_gui"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.build_gui">[docs]</a>    <span class="k">def</span> <span class="nf">build_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the GUI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#try to load file at the start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">build_gui</span><span class="p">()</span></div>

<div class="viewcode-block" id="SasViewApp.set_welcome_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.set_welcome_panel">[docs]</a>    <span class="k">def</span> <span class="nf">set_welcome_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panel_class</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the welcome panel</span>

<span class="sd">        :param panel_class: class of the welcome panel to be instantiated</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">welcome_panel_class</span> <span class="o">=</span> <span class="n">panel_class</span></div>

<div class="viewcode-block" id="SasViewApp.add_perspective"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.add_perspective">[docs]</a>    <span class="k">def</span> <span class="nf">add_perspective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perspective</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Manually add a perspective to the application GUI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">add_perspective</span><span class="p">(</span><span class="n">perspective</span><span class="p">)</span></div>

<div class="viewcode-block" id="SasViewApp.window_placement"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.window_placement">[docs]</a>    <span class="k">def</span> <span class="nf">window_placement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the position and size of the application frame such that it</span>
<span class="sd">        fits on the user&#39;s screen without obstructing (or being obstructed by)</span>
<span class="sd">        the Windows task bar.  The maximum initial size in pixels is bounded by</span>
<span class="sd">        WIDTH x HEIGHT.  For most monitors, the application</span>
<span class="sd">        will be centered on the screen; for very large monitors it will be</span>
<span class="sd">        placed on the left side of the screen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_maximized</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1"># Get size of screen without</span>
        <span class="k">for</span> <span class="n">screenCount</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Display</span><span class="p">()</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()):</span>
            <span class="n">screen</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Display</span><span class="p">(</span><span class="n">screenCount</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">screen</span><span class="o">.</span><span class="n">IsPrimary</span><span class="p">():</span>
                <span class="n">displayRect</span> <span class="o">=</span> <span class="n">screen</span><span class="o">.</span><span class="n">GetClientArea</span><span class="p">()</span>
                <span class="k">break</span>

        <span class="n">posX</span><span class="p">,</span> <span class="n">posY</span><span class="p">,</span> <span class="n">displayWidth</span><span class="p">,</span> <span class="n">displayHeight</span> <span class="o">=</span> <span class="n">displayRect</span>
        <span class="n">customWidth</span><span class="p">,</span> <span class="n">customHeight</span> <span class="o">=</span> <span class="n">size</span>

        <span class="c1"># If the custom size is default, set 90% of the screen size</span>
        <span class="k">if</span> <span class="n">customWidth</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">customHeight</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">customWidth</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">customHeight</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">is_maximized</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">customWidth</span> <span class="o">=</span> <span class="n">displayWidth</span> <span class="o">*</span> <span class="mf">0.9</span>
            <span class="n">customHeight</span> <span class="o">=</span> <span class="n">displayHeight</span> <span class="o">*</span> <span class="mf">0.9</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the custom screen is bigger than the</span>
            <span class="c1"># window screen than make maximum size</span>
            <span class="k">if</span> <span class="n">customWidth</span> <span class="o">&gt;</span> <span class="n">displayWidth</span><span class="p">:</span>
                <span class="n">customWidth</span> <span class="o">=</span> <span class="n">displayWidth</span>
            <span class="k">if</span> <span class="n">customHeight</span> <span class="o">&gt;</span> <span class="n">displayHeight</span><span class="p">:</span>
                <span class="n">customHeight</span> <span class="o">=</span> <span class="n">displayHeight</span>

        <span class="c1"># Note that when running Linux and using an Xming (X11) server on a PC</span>
        <span class="c1"># with a dual  monitor configuration, the reported display size may be</span>
        <span class="c1"># that of both monitors combined with an incorrect display count of 1.</span>
        <span class="c1"># To avoid displaying this app across both monitors, we check for</span>
        <span class="c1"># screen &#39;too big&#39;.  If so, we assume a smaller width which means the</span>
        <span class="c1"># application will be placed towards the left hand side of the screen.</span>

        <span class="c1"># If dual screen registered as 1 screen. Make width half.</span>
        <span class="c1"># MAC just follows the default behavior of pos</span>
        <span class="k">if</span> <span class="n">IS_WIN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">displayWidth</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">displayHeight</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">customWidth</span> <span class="o">==</span> <span class="n">displayWidth</span><span class="p">:</span>
                    <span class="n">customWidth</span> <span class="o">=</span> <span class="n">displayWidth</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="c1"># and set the position to be the corner of the screen.</span>
                <span class="n">posX</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">posY</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Make the position the middle of the screen. (Not 0,0)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">posX</span> <span class="o">=</span> <span class="p">(</span><span class="n">displayWidth</span> <span class="o">-</span> <span class="n">customWidth</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="n">posY</span> <span class="o">=</span> <span class="p">(</span><span class="n">displayHeight</span> <span class="o">-</span> <span class="n">customHeight</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="c1"># Return the suggested position and size for the application frame.</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">posX</span><span class="p">,</span> <span class="n">posY</span><span class="p">),</span> <span class="p">(</span><span class="n">customWidth</span><span class="p">,</span> <span class="n">customHeight</span><span class="p">),</span> <span class="n">is_maximized</span></div>


<div class="viewcode-block" id="SasViewApp.display_splash_screen"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.display_splash_screen">[docs]</a>    <span class="k">def</span> <span class="nf">display_splash_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span>
                              <span class="n">path</span><span class="o">=</span><span class="n">SPLASH_SCREEN_PATH</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Displays the splash screen.  It will exactly cover the main frame.&quot;&quot;&quot;</span>

        <span class="c1"># Prepare the picture.  On a 2GHz intel cpu, this takes about a second.</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_PNG</span><span class="p">)</span>
        <span class="n">image</span><span class="o">.</span><span class="n">Rescale</span><span class="p">(</span><span class="n">SPLASH_SCREEN_WIDTH</span><span class="p">,</span>
                      <span class="n">SPLASH_SCREEN_HEIGHT</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">IMAGE_QUALITY_HIGH</span><span class="p">)</span>
        <span class="n">bm</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">ConvertToBitmap</span><span class="p">()</span>

        <span class="c1"># Create and show the splash screen.  It will disappear only when the</span>
        <span class="c1"># program has entered the event loop AND either the timeout has expired</span>
        <span class="c1"># or the user has left clicked on the screen.  Thus any processing</span>
        <span class="c1"># performed in this routine (including sleeping) or processing in the</span>
        <span class="c1"># calling routine (including doing imports) will prevent the splash</span>
        <span class="c1"># screen from disappearing.</span>
        <span class="c1">#</span>
        <span class="c1"># Note that on Linux, the timeout appears to occur immediately in which</span>
        <span class="c1"># case the splash screen disappears upon entering the event loop.</span>
        <span class="n">s_screen</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">SplashScreen</span><span class="p">(</span><span class="n">bitmap</span><span class="o">=</span><span class="n">bm</span><span class="p">,</span>
                                   <span class="n">splashStyle</span><span class="o">=</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">SPLASH_TIMEOUT</span> <span class="o">|</span>
                                                <span class="n">wx</span><span class="o">.</span><span class="n">SPLASH_CENTRE_ON_SCREEN</span><span class="p">),</span>
                                   <span class="n">style</span><span class="o">=</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">SIMPLE_BORDER</span> <span class="o">|</span>
                                          <span class="n">wx</span><span class="o">.</span><span class="n">FRAME_NO_TASKBAR</span> <span class="o">|</span>
                                          <span class="n">wx</span><span class="o">.</span><span class="n">FRAME_FLOAT_ON_PARENT</span><span class="p">),</span>
                                   <span class="n">milliseconds</span><span class="o">=</span><span class="n">SS_MAX_DISPLAY_TIME</span><span class="p">,</span>
                                   <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                                   <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">sas.sasgui.guiframe.gui_statusbar</span> <span class="kn">import</span> <span class="n">SPageStatusbar</span>
        <span class="n">statusBar</span> <span class="o">=</span> <span class="n">SPageStatusbar</span><span class="p">(</span><span class="n">s_screen</span><span class="p">)</span>
        <span class="n">s_screen</span><span class="o">.</span><span class="n">SetStatusBar</span><span class="p">(</span><span class="n">statusBar</span><span class="p">)</span>
        <span class="n">s_screen</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_close_splash_screen</span><span class="p">)</span>
        <span class="n">s_screen</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s_screen</span></div>


<div class="viewcode-block" id="SasViewApp.on_close_splash_screen"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.SasViewApp.on_close_splash_screen">[docs]</a>    <span class="k">def</span> <span class="nf">on_close_splash_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When the splash screen is closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximize_win</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="MDIFrame"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.MDIFrame">[docs]</a><span class="k">class</span> <span class="nc">MDIFrame</span><span class="p">(</span><span class="n">CHILD_FRAME</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Frame for panels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">panel</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Untitled&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">)):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        comment</span>
<span class="sd">        :param parent: parent panel/container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the Frame object</span>
        <span class="n">CHILD_FRAME</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Untitled&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_on</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">batch_on</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">panel</span>
        <span class="k">if</span> <span class="n">panel</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_panel</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<div class="viewcode-block" id="MDIFrame.show_data_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.MDIFrame.show_data_panel">[docs]</a>    <span class="k">def</span> <span class="nf">show_data_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Turns on the data panel</span>

<span class="sd">        The the data panel is optional.  Most of its functions can be</span>
<span class="sd">        performed from the menu bar and from the plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">show_data_panel</span><span class="p">(</span><span class="n">action</span><span class="p">)</span></div>

<div class="viewcode-block" id="MDIFrame.set_panel"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.MDIFrame.set_panel">[docs]</a>    <span class="k">def</span> <span class="nf">set_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">panel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">panel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">window_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">window_caption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetHelpText</span><span class="p">(</span><span class="n">panel</span><span class="o">.</span><span class="n">help_string</span><span class="p">)</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_get_panels_size</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span> <span class="s2">&quot;CENTER_PANE&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">panel</span><span class="o">.</span><span class="n">CENTER_PANE</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">*=</span> <span class="mf">0.6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">put_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SET_FOCUS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_panel_focus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnClose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="MDIFrame.set_panel_focus"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.MDIFrame.set_panel_focus">[docs]</a>    <span class="k">def</span> <span class="nf">set_panel_focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">panel_on_focus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panel</span></div>

<div class="viewcode-block" id="MDIFrame.OnClose"><a class="viewcode-back" href="../../../../dev/api/sas.sasgui.guiframe.html#sas.sasgui.guiframe.gui_manager.MDIFrame.OnClose">[docs]</a>    <span class="k">def</span> <span class="nf">OnClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On Close event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">on_close</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div></div>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">SasViewApp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">SasView 4.0.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../guiframe.html" >sas.sasgui.guiframe</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, The SasView Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>